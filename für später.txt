<script>
<div class="stats-box" style="margin-top: 20px;">
  <label for="gptPrompt">ü§ñ Frage an ChatGPT:</label>
  <textarea id="gptPrompt" placeholder="z.‚ÄØB. War mein Entry gut?" style="width: 100%; height: 60px;"></textarea>

  <button onclick="askGPT()" style="margin-top: 10px; background: #0077cc; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer;">
    ‚ú® GPT analysieren
  </button>

  <div id="gptResult" style="margin-top: 12px; background: #222; color: #0f0; padding: 10px; border-radius: 8px; font-family: monospace;"></div>
</div>

const openaiKey = "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";
const openaiProjectId = "proj_70VulXoamT5tAtb0tSV80nS6"; // ‚úÖ DEINE Project-ID

async function askGPT() {
  const prompt = document.getElementById("gptPrompt").value.trim();
  const outputBox = document.getElementById("gptResult");

  if (!prompt) {
    outputBox.innerHTML = "‚ùå Bitte zuerst eine Frage eingeben.";
    outputBox.style.color = "#f44";
    return;
  }

  outputBox.innerHTML = "‚è≥ GPT denkt nach...";
  outputBox.style.color = "#0f0";

  try {
const res = await fetch("http://localhost:4000/gpt", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    model: "gpt-3.5-turbo",
    messages: [
      { role: "system", content: "Du bist ein Trading-Coach. Antworte ehrlich, klar und direkt." },
      { role: "user", content: prompt }
    ],
    temperature: 0.7
  })
});


    if (!res.ok) throw new Error(`HTTP Fehler: ${res.status} ${res.statusText}`);

    const data = await res.json();
    console.log("‚úÖ GPT Antwort:", data);
    const reply = data?.choices?.[0]?.message?.content || "‚ùå GPT hat nichts zur√ºckgegeben.";
    outputBox.innerHTML = reply.replace(/\n/g, "<br>");
  } catch (err) {
    console.error("‚ùå GPT Fehler:", err);
    outputBox.innerHTML = "‚ùå Fehler bei der Anfrage: " + err.message;
    outputBox.style.color = "#f44";
  }
}
</script>