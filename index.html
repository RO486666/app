<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trade App Layout</title>
  <style>
    body { background: #111; color: white; font-family: sans-serif; margin: 0; padding: 0; }
    .header { background: #1c1c1c; padding: 10px; text-align: center; font-size: 18px; }
    .session-bar { height: 10px; background: linear-gradient(to right, #00aaff, #ffaa00, #ff3300); margin-top: 5px; }
    .main { padding: 20px; padding-bottom: 120px; text-align: center; }

    .big-btn { padding: 20px 30px; font-size: 22px; font-weight: bold; border-radius: 15px; border: none; background-color: #00aa44; color: white; margin: 20px auto; width: 80%; max-width: 300px; }

    .tab-buttons { text-align: center; margin-top: 20px; }
    .tab-buttons button { background: #333; color: white; padding: 10px 15px; border-radius: 5px; margin: 5px; border: none; font-weight: bold; cursor: pointer; }
    .tab-buttons .active { background: #0077cc; }

    .stats-box { background: #222; padding: 15px; border-radius: 10px; margin-top: 20px; text-align: left; }

    .position-bar {
      flex-wrap: nowrap;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      position: fixed;
      bottom: 0;
      width: 100%;
      background: #1c1c1c;
      padding: 10px;
      display: flex;
      overflow-x: auto;
      gap: 10px;
      border-top: 2px solid #333;
    }
    .trade-box {
      flex: 0 0 auto;
      box-sizing: border-box;
      width: 85%;
      max-width: 280px;
      background: #333;
      padding: 10px;
      border-radius: 10px;
      min-width: 180px;
    }
	
.progress-container {
  position: relative;
  background: #111;
  height: 24px;
  width: 100%;
  border-top: 1px solid #333;
  border-bottom: 1px solid #333;
  overflow: visible; /* damit der Glow nicht abgeschnitten wird */

  /* Leuchtender Ring au√üen */
    box-shadow: 0 0 12px 6px rgba(0, 0, 0, 0);
  border-radius: 6px;
}

.alert-below-header {
  position: relative;
  width: 100%;
  height: 30px;
  overflow: hidden;
  background: transparent;
}

.alert-message {
  position: absolute;
  white-space: nowrap;
  top: 0;
  color: black;
  background: #ffaa00;
  padding: 5px 20px;
  border-radius: 0 0 10px 10px;
  animation: slideAcross 5s linear forwards;
  font-weight: bold;
}

@keyframes slideAcross {
  0%   { left: 100%; }
  10%  { left: 0%; }
  90%  { left: 0%; }
  100% { left: -100%; }
}



.ticker {
  width: 100%;
  background: #222;           /* dunkler Hintergrund */
  color: #00ff99;             /* Schriftfarbe (z.B. knalliges Gr√ºn) */
  padding: 10px;
  text-align: center;         /* Text horizontal zentrieren */
  font-size: 18px;
  font-weight: bold;
  font-family: Arial, sans-serif;
  user-select: none;
}
.progress-container {
  position: relative;
  background: #111;
  height: 24px;
  width: 100%;
  border-top: 1px solid #333;
  border-bottom: 1px solid #333;
  overflow: hidden;
}

.progress-bar {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 0%; /* wird per JS gesetzt */
  background: #222;
  z-index: 2;
  transition: width 1s linear;
  background-size: 100% 100%;
  background-repeat: no-repeat;
}

@keyframes slideAcross {
  0%   { left: 100%; }
  40%  { left: 50%; transform: translateX(-50%); } /* mittig */
  70%  { left: 50%; transform: translateX(-50%); } /* steht in der Mitte */
  100% { left: 200%; } /* raus nach rechts */
}

.alert-message {
  position: absolute;
  white-space: nowrap;
  top: 0;
  color: black;
  background: #ffaa00;
  padding: 5px 20px;
  border-radius: 0 0 10px 10px;
  animation: slideAcross 5s ease forwards;
  font-weight: bold;
  transform: translateX(0); /* Start ohne Offset */
}

.session-info {
  margin-top: 5px;
  font-size: 14px;
  color: #aaf0aa; /* angenehmes Gr√ºn f√ºr Tipps */
  text-align: center;
  font-style: italic;
  user-select: none;
}

.open-bar {
  position: fixed;
  bottom: 0;
  right: 0;
  width: 300px;
  max-height: 400px;
  overflow-y: auto;
  background: #222;
  border-radius: 10px 0 0 10px;
  box-shadow: -3px 0 10px rgba(0,0,0,0.5);
  padding: 10px;
  z-index: 10000;
}

.open-bar {
  position: fixed;
  bottom: 0;
  right: 0;
  width: 320px;
  max-height: 400px;
  overflow-y: auto;
  background: #222;
  border-radius: 10px 0 0 10px;
  box-shadow: -3px 0 10px rgba(0,0,0,0.5);
  padding: 10px;
  z-index: 10000;
  font-family: Arial, sans-serif;
}
.trade-box {
  padding: 10px;
  margin-bottom: 8px;
  border-radius: 6px;
  color: white;
  user-select: none;
}

.trade-box.Long {
  background-color: #228B22; /* gr√ºn */
}

.trade-box.Short {
  background-color: #B22222; /* rot */
}

.result-value {
  margin-top: 5px;
  font-weight: bold;
}


    .popup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #222; padding: 20px; border-radius: 10px; display: none; z-index: 1000; width: 90%; max-width: 300px; }
    select, input { padding: 8px; margin-top: 10px; width: 100%; border-radius: 5px; border: none; font-size: 16px; }
    .popup button { margin-top: 10px; padding: 10px; width: 100%; font-size: 16px; }
  </style>
</head>
<body>
// Copyride Roman Kleis
<div class="ticker" id="sessionText">Session-Zeit: 00:00</div>
<div class="session-info" id="sessionInfo">Tipps und Infos zur Session erscheinen hier...</div>

<div class="progress-container">
  <div class="progress-bar" id="progressBar"></div>
</div>

<div class="alert-below-header" id="alertBox"></div>
  
  
  
  <div class="main">
    <button class="big-btn" onclick="showPopup()">+ Trade starten</button>

    <div class="tab-buttons">
      <button class="btn active" onclick="switchTab('tag')">Tag</button>
      <button class="btn" onclick="switchTab('woche')">Woche</button>
      <button class="btn" onclick="switchTab('monat')">Monat</button>
    </div>
    <div class="stats-box" id="tagBox">
      <h3>üìÖ Tagesauswertung</h3>
      <p>Gewinne: 0 | Verluste: 0</p>
      <p>Gesamt PnL: 0 ‚Ç¨</p>
      <p>Profitfaktor: ‚Äì</p>
      <p>Durchschnitt Gewinn/Verlust: ‚Äì</p>
    </div>


    <div class="stats-box" id="wocheBox" style="display:none">
      <h3>üìà Wochenauswertung</h3>
      <p>Gewinne: 0 | Verluste: 0</p>
      <p>Gesamt PnL: 0 ‚Ç¨</p>
      <p>Profitfaktor: ‚Äì</p>
      <p>Durchschnitt Gewinn/Verlust: ‚Äì</p>
    </div>

    <div class="stats-box" id="monatBox" style="display:none">
      <h3>üìä Monatsauswertung</h3>
      <p>Gewinne: 0 | Verluste: 0</p>
      <p>Gesamt PnL: 0 ‚Ç¨</p>
      <p>Profitfaktor: ‚Äì</p>
      <p>Durchschnitt Gewinn/Verlust: ‚Äì</p>
    </div>
  </div>
  <div class="popup" id="tradePopup">
    <h3>Trade eingeben</h3>
   <select id="pairSelect">
  <option value="">Paar w√§hlen</option>
  <option value="AUD/CAD">AUD/CAD</option>
  <option value="AUD/JPY">AUD/JPY</option>
  <option value="AUD/USD">AUD/USD</option>
  <option value="CHF/JPY">CHF/JPY</option>
  <option value="EUR/AUD">EUR/AUD</option>
  <option value="EUR/CAD">EUR/CAD</option>
  <option value="EUR/GBP">EUR/GBP</option>
  <option value="EUR/JPY">EUR/JPY</option>
  <option value="EUR/USD">EUR/USD</option>
  <option value="GBP/AUD">GBP/AUD</option>
  <option value="GBP/JPY">GBP/JPY</option>
  <option value="GBP/USD">GBP/USD</option>
  <option value="NZD/JPY">NZD/JPY</option>
  <option value="NZD/USD">NZD/USD</option>
  <option value="USD/CAD">USD/CAD</option>
  <option value="USD/CHF">USD/CHF</option>
  <option value="USD/JPY">USD/JPY</option>
  <option value="XAG/USD">XAG/USD</option>
  <option value="XAU/USD">XAU/USD</option>
</select>
    <select id="directionSelect">
      <option value="">Richtung w√§hlen</option>
      <option value="Long">Long</option>
      <option value="Short">Short</option>
    </select>
   
  <div id="pairToggleContainer" style="margin-top: 10px; max-height: 150px; overflow-y: auto; background: #222; padding: 5px; border-radius: 6px; color: white;">
    <strong>Paare ein-/ausblenden:</strong><br>
    <!-- Checkboxen per JS rein -->
  </div>
  
 <button onclick="addTrade()">Trade speichern</button>
  </div>
  <div class="popup" id="resultPopup">
    <h3>Ergebnis</h3>
    <input type="number" inputmode="decimal" id="pnlInput" placeholder="z.‚ÄØB. 120.50">
    <button onclick="saveResult()">Speichern</button>
  </div>
  
 
<div id="resetBar" style="
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: #cc3333;
  color: white;
  text-align: center;
  padding: 14px 0;
  font-size: 18px;
  font-weight: bold;
  cursor: pointer;
  user-select: none;
  z-index: 9999;
  box-shadow: 0 -2px 6px rgba(0,0,0,0.3);
" onclick="resetAll()">
  Alles zur√ºcksetzen
</div>
  <div class="position-bar" id="positionBar"></div>

  <script>
const pairs = [
  "EUR/USD",
  "USD/JPY",
  "GBP/USD",
  "USD/CHF",
  "AUD/USD",
  "USD/CAD",
  "NZD/USD",
  "EUR/GBP",
  "EUR/JPY",
  "GBP/JPY",
  "AUD/JPY",
  "CHF/JPY",
  "EUR/AUD",
  "EUR/CAD",
  "GBP/AUD",
  "AUD/CAD",
  "NZD/JPY",
  "XAU/USD",
  "XAG/USD"
];

// alphabetisch sortieren
const pairsSorted = pairs.slice().sort((a,b) => a.localeCompare(b));

function initTradePopup() {
  // Select bef√ºllen
  const pairSelect = document.getElementById("pairSelect");
  // erst alle Options au√üer der ersten entfernen
  while (pairSelect.options.length > 1) {
    pairSelect.remove(1);
  }
  pairsSorted.forEach(pair => {
    const option = document.createElement("option");
    option.value = pair;
    option.textContent = pair;
    pairSelect.appendChild(option);
  });

  // Checkboxen im Filter-Container bef√ºllen
  const toggleContainer = document.getElementById("pairToggleContainer");
  toggleContainer.innerHTML = ''; // vorher leeren

  pairsSorted.forEach(pair => {
    const label = document.createElement("label");
    label.style.marginRight = "10px";
    label.style.cursor = "pointer";
    label.style.userSelect = "none";

    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.value = pair;
    checkbox.checked = true;
    checkbox.addEventListener("change", updateVisiblePairs);

    label.appendChild(checkbox);
    label.appendChild(document.createTextNode(" " + pair));
    toggleContainer.appendChild(label);
  });
}



// Filtert die sichtbaren Trades basierend auf Checkboxen
function updateVisiblePairs() {
  const checkedPairs = Array.from(document.querySelectorAll("#pairToggleContainer input[type=checkbox]:checked"))
    .map(cb => cb.value);

  document.querySelectorAll(".trade-box").forEach(box => {
    const pairName = box.querySelector("strong").textContent;
    if (checkedPairs.includes(pairName)) {
      box.style.display = "block";
    } else {
      box.style.display = "none";
    }
  });
}

	 
	 function resetAll() {
  if (!confirm("Willst du wirklich ALLE Trades und Statistiken l√∂schen?")) return;

  tradesData.length = 0; // Array leeren
  localStorage.removeItem("tradesData"); // Speicher l√∂schen
  document.getElementById("positionBar").innerHTML = ""; // UI leeren
  updateStats(); // Statistik zur√ºcksetzen (alles auf 0)
}
	 
  function isSameDay(date1, date2) {
    return date1.getDate() === date2.getDate() &&
           date1.getMonth() === date2.getMonth() &&
           date1.getFullYear() === date2.getFullYear();
  }

  function isSameWeek(date1, date2) {
    const startOfWeek = new Date(date2);
    startOfWeek.setDate(date2.getDate() - date2.getDay()); // Sonntag = 0
    const endOfWeek = new Date(startOfWeek);
    endOfWeek.setDate(startOfWeek.getDate() + 6);
    return date1 >= startOfWeek && date1 <= endOfWeek;
  }

  function isSameMonth(date1, date2) {
    return date1.getMonth() === date2.getMonth() &&
           date1.getFullYear() === date2.getFullYear();
  }

  const tradesData = [];
  let activeBox = null;
  let resultType = "win";

  // L√§dt gespeicherte Trades aus localStorage und rendert sie
function loadTrades() {
  const saved = localStorage.getItem("tradesData");
  if (saved) {
    const arr = JSON.parse(saved);
    tradesData.length = 0; // Sicherstellen, dass kein doppeltes Laden entsteht
    document.getElementById("positionBar").innerHTML = ""; // Alte Boxes weg
    arr.forEach(trade => {
      trade.date = new Date(trade.date);
      tradesData.push(trade);
      if (trade.pnl === null) {
        renderTradeBox(trade);
      }
    });
  }
  updateStats(); // Statistik aktualisieren
}

window.onload = loadTrades;

  // Speichert alle Trades in localStorage
  function saveTrades() {
    localStorage.setItem("tradesData", JSON.stringify(tradesData));
  }

  // Rendert eine Trade-Box in der Positionsleiste
  function renderTradeBox(tradeObj) {
    const box = document.createElement("div");
    box.className = "trade-box " + tradeObj.direction;
    box.dataset.id = tradeObj.id;

    let resultText = "";
    if (tradeObj.pnl !== null) {
      resultText = `<div class="result-value">PnL: ${tradeObj.pnl.toFixed(2)} ‚Ç¨</div>`;
    } else {
      resultText = `
        <button onclick="markResult(this, 'win')">‚úÖ Erfolg</button>
        <button onclick="markResult(this, 'loss')">‚ùå Misserfolg</button>
        <div class="result-value"></div>
      `;
    }

    box.innerHTML = `
      <strong>${tradeObj.pair}</strong><br>${tradeObj.direction}<br>
      ${resultText}
    `;
    document.getElementById("positionBar").appendChild(box);
  }

  // F√ºgt einen neuen Trade hinzu
  function addTrade() {
    const pair = document.getElementById("pairSelect").value;
    const direction = document.getElementById("directionSelect").value;
    if (!pair || !direction) return;

    const now = new Date();
    const tradeObj = {
      id: Date.now(),
      pair: pair,
      direction: direction,
      date: now,
      pnl: null,
      resultType: null
    };

    tradesData.push(tradeObj);
    renderTradeBox(tradeObj);
    saveTrades();  // Speichern nach √Ñnderung

    hidePopups();
  }

  // Zeigt Popup f√ºr Ergebnis-Eingabe an
  function markResult(btn, type) {
    activeBox = btn.closest(".trade-box");
    resultType = type;
    document.getElementById("pnlInput").value = "";
    document.getElementById("resultPopup").style.display = "block";
  }

  // Ergebnis speichern und Statistik aktualisieren
  function saveResult() {
    let pnlRaw = document.getElementById("pnlInput").value.replace(",", ".");
    if (pnlRaw === "") return;
    let pnl = parseFloat(pnlRaw);
    if (isNaN(pnl)) return;
    pnl = Math.abs(pnl);
    pnl = resultType === "loss" ? -pnl : pnl;

    const resultDiv = activeBox.querySelector(".result-value");
    resultDiv.innerText = `PnL: ${pnl.toFixed(2)} ‚Ç¨`;

    const tradeId = Number(activeBox.dataset.id);
    const trade = tradesData.find(t => t.id === tradeId);
    if (trade) {
      trade.pnl = pnl;
      trade.resultType = resultType;
    }

    // Trade aus der Anzeige entfernen, wenn Ergebnis eingetragen
    activeBox.remove();

    saveTrades();  // Speichern nach √Ñnderung

    hidePopups();
    updateStats();
  }

  // Statistik f√ºr Tag, Woche, Monat aktualisieren
  function updateStats() {
    const now = new Date();

    function calcStats(filterFn) {
      const filtered = tradesData.filter(t => t.pnl !== null && filterFn(t.date));
      const wins = filtered.filter(t => t.pnl > 0);
      const losses = filtered.filter(t => t.pnl < 0);
      const totalPnl = filtered.reduce((sum, t) => sum + t.pnl, 0);

      const profitFactor = losses.length === 0 ? '‚Äì' : (wins.reduce((s, t) => s + t.pnl, 0) / Math.abs(losses.reduce((s, t) => s + t.pnl, 0))).toFixed(2);
      const avg = filtered.length === 0 ? '‚Äì' : (totalPnl / filtered.length).toFixed(2);

      const totalTrades = wins.length + losses.length;
      const profitPercent = totalTrades === 0 ? null : (wins.length / totalTrades) * 100;

      return {
        wins: wins.length,
        losses: losses.length,
        totalPnl,
        avg,
        totalTrades,
        profitPercent
      };
    }

    const isToday = date => isSameDay(date, now);
    const isThisWeek = date => isSameWeek(date, now);
    const isThisMonth = date => isSameMonth(date, now);

    const dayStats = calcStats(isToday);
    const weekStats = calcStats(isThisWeek);
    const monthStats = calcStats(isThisMonth);

    function colorText(value, isPnl = false) {
      if (isPnl) {
        return value >= 0 ? `<span style="color: #0f0;">${value.toFixed(2)} ‚Ç¨</span>` : `<span style="color: #f44;">${value.toFixed(2)} ‚Ç¨</span>`;
      } else {
        return `<span style="color: ${value > 0 ? '#0f0' : '#f44'}">${value}</span>`;
      }
    }

    function colorProfitPercent(p) {
      if (p === null) return "‚Äì";
      if (p < 35) return `<span style="color:#f44">${p.toFixed(1)}%</span>`;
      if (p < 50) return `<span style="color:#ffcc00">${p.toFixed(1)}%</span>`;
      if (p < 75) return `<span style="color:#9acd32">${p.toFixed(1)}%</span>`;
      return `<span style="color:#008000">${p.toFixed(1)}%</span>`;
    }

    // Tag
    const tagBox = document.getElementById("tagBox");
    tagBox.querySelector("p:nth-child(2)").innerHTML = `Gewinne: ${colorText(dayStats.wins)} | Verluste: ${colorText(dayStats.losses)}`;
    tagBox.querySelector("p:nth-child(3)").innerHTML = `Gesamt PnL: ${colorText(dayStats.totalPnl, true)}`;
    tagBox.querySelector("p:nth-child(4)").innerHTML = `Anzahl Trades: ${dayStats.totalTrades}`;
    tagBox.querySelector("p:nth-child(5)").innerHTML = `Profitabel: ${colorProfitPercent(dayStats.profitPercent)}`;

    // Woche
    const wocheBox = document.getElementById("wocheBox");
    wocheBox.querySelector("p:nth-child(2)").innerHTML = `Gewinne: ${colorText(weekStats.wins)} | Verluste: ${colorText(weekStats.losses)}`;
    wocheBox.querySelector("p:nth-child(3)").innerHTML = `Gesamt PnL: ${colorText(weekStats.totalPnl, true)}`;
    wocheBox.querySelector("p:nth-child(4)").innerHTML = `Anzahl Trades: ${weekStats.totalTrades}`;
    wocheBox.querySelector("p:nth-child(5)").innerHTML = `Profitabel: ${colorProfitPercent(weekStats.profitPercent)}`;

    // Monat
    const monatBox = document.getElementById("monatBox");
    monatBox.querySelector("p:nth-child(2)").innerHTML = `Gewinne: ${colorText(monthStats.wins)} | Verluste: ${colorText(monthStats.losses)}`;
    monatBox.querySelector("p:nth-child(3)").innerHTML = `Gesamt PnL: ${colorText(monthStats.totalPnl, true)}`;
    monatBox.querySelector("p:nth-child(4)").innerHTML = `Anzahl Trades: ${monthStats.totalTrades}`;
    monatBox.querySelector("p:nth-child(5)").innerHTML = `Profitabel: ${colorProfitPercent(monthStats.profitPercent)}`;
  }

  // Tab wechseln Funktion
  function switchTab(tab) {
    document.querySelectorAll('.tab-buttons button').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.stats-box').forEach(box => box.style.display = 'none');
    document.getElementById(tab + 'Box').style.display = 'block';
    document.querySelectorAll('.tab-buttons button').forEach(btn => {
      if (btn.innerText.toLowerCase().includes(tab)) btn.classList.add('active');
    });
  }

  // Popups ein/ausblenden
  function showPopup() {
    document.getElementById("tradePopup").style.display = "block";
  }

  function hidePopups() {
    document.getElementById("tradePopup").style.display = "none";
    document.getElementById("resultPopup").style.display = "none";
  }

  // Lade Trades direkt beim Laden der Seite
  window.addEventListener("load", () => {
  initTradePopup();
  loadTrades();
});
  </script>

x<script>
// Alles f√ºr Sessionbarund info

const sessionText = document.getElementById("sessionText");
  const progressBar = document.getElementById("progressBar");
  const progressContainer = document.querySelector(".progress-container");
  const alertBox = document.getElementById("alertBox");
  const sessionInfoEl = document.getElementById("sessionInfo");

  const sessionColors = {
    "Sydney": "#3388ff",
    "Tokyo": "#00aaff",
    "London": "#ffd700",
    "New York": "#ff4500",
    "London Killzone": "#ccff00",
    "New York Killzone": "#ff8800",
    "Deadzone": "#333"
  };

  const sessions = [
   { name: "Sydney", start: 1380, end: 480, info: "Ruhiger Markt ‚Äì gute Planung m√∂glich." },
  { name: "Tokyo", start: 60, end: 600, info: "Asia-Zeit ‚Äì Breakouts m√∂glich." },
  { name: "London", start: 540, end: 1020, info: "Volatilit√§t steigt ‚Äì gute Bewegungen." },
  { name: "New York", start: 870, end: 1380, info: "Hauptmarkt ‚Äì oft starke Impulse." },
  { name: "London Killzone", start: 420, end: 660, info: "Volatile Phase ‚Äì viele Trades m√∂glich." },
  { name: "New York Killzone", start: 810, end: 1020, info: "Volatile Phase ‚Äì erh√∂hte Aufmerksamkeit." },
  { name: "Deadzone", start: 1380, end: 0, info: "Wenig Bewegung ‚Äì keine aktive Session." }
  ];

  let lastAlertSession = null;

  function getMinutesNow() {
    const now = new Date();
    return now.getHours() * 60 + now.getMinutes();
  }
  


  function getCurrentSessions(minNow) {
    return sessions.filter(s => {
      const start = s.start;
      const end = s.end;
      if (start > end) {
        return minNow >= start || minNow < end;
      } else {
        return minNow >= start && minNow < end;
      }
    });
  }

  function updateGradientBar(colors) {
    if (colors.length === 0) {
      progressBar.style.background = "#444";
      progressBar.style.backgroundImage = "";
      return;
    }

    const svg = `
      <svg xmlns='http://www.w3.org/2000/svg' width='100%' height='100%'>
        <defs>
          <linearGradient id='g' x1='0%' y1='0%' x2='100%' y2='0%'>
            ${colors.map((c, i) => `<stop offset='${(i / (colors.length - 1)) * 100}%' stop-color='${c}'/>`).join("")}
          </linearGradient>
        </defs>
        <rect x='0' y='0' width='100%' height='100%' fill='url(#g)'/>
      </svg>`;
    const base64 = btoa(svg);
    progressBar.style.backgroundImage = `url("data:image/svg+xml;base64,${base64}")`;
  }

  function hexToRgba(hex, alpha) {
    hex = hex.replace('#', '');
    const r = parseInt(hex.substring(0,2), 16);
    const g = parseInt(hex.substring(2,4), 16);
    const b = parseInt(hex.substring(4,6), 16);
    return `rgba(${r},${g},${b},${alpha})`;
  }

  function getMinutesToNextSession(minNow) {
    const futureStarts = sessions
      .map(s => s.start)
      .filter(start => start > minNow);

    if(futureStarts.length === 0) {
      return sessions[0].start + 1440 - minNow;
    }

    const nextStart = Math.min(...futureStarts);
    return nextStart - minNow;
  }

  function showAlert(msg) {
    const el = document.createElement("div");
    el.className = "alert-message";
    el.textContent = msg;
    alertBox.innerHTML = "";
    alertBox.appendChild(el);
    setTimeout(() => alertBox.innerHTML = "", 5000);
  }

  function updateRealTimeBar() {
    const now = new Date();
    const minutes = getMinutesNow();
    const percent = (minutes / 1439) * 100;
    progressBar.style.width = percent + "%";

    const activeSessions = getCurrentSessions(minutes);
    const names = activeSessions.map(s => s.name);
    const colors = names.map(name => sessionColors[name] || "#666");

    updateGradientBar(colors);

    if (colors.length > 0) {
      progressContainer.style.boxShadow = `0 0 12px 6px ${hexToRgba(colors[0], 0.6)}`;
    } else {
      progressContainer.style.boxShadow = "0 0 12px 6px rgba(0,0,0,0)";
    }

    const hours = String(now.getHours()).padStart(2, '0');
    const mins = String(now.getMinutes()).padStart(2, '0');
    const sessionInfo = names.length > 0 ? `‚Äì ${names.join(" + ")} l√§uft` : "‚Äì Keine Session aktiv";
    sessionText.textContent = `üïí Aktuelle Uhrzeit: ${hours}:${mins} ${sessionInfo}`;
if (activeSessions.length > 0) {
  sessionInfoEl.textContent = activeSessions[0].info || "Keine weiteren Infos.";
} else {
  sessionInfoEl.textContent = "Keine aktive Session ‚Äì Markt ruhig.";
}
    // Warnung 5 Minuten vor Sessionwechsel
    const minutesToNext = getMinutesToNextSession(minutes);

    if (minutesToNext <= 5 && minutesToNext > 0) {
      if (lastAlertSession !== sessionInfo) {
        showAlert(`‚ö†Ô∏è Session-Wechsel in 5 Minuten!`);
        lastAlertSession = sessionInfo;
      }
    } else {
      lastAlertSession = null;
    }
  }
  

  setInterval(updateRealTimeBar, 60000);
  updateRealTimeBar();
</script>
</body>
</html>
