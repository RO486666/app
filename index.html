<!DOCTYPE html>
<html lang="de">
<head>
<link rel="stylesheet" href="CSS/ticker.css" />
<link rel="stylesheet" href="CSS/star.css" />
<link rel="stylesheet" href="CSS/session.css" />
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#00aa44" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trade App Layout</title>
  <style>
html, body {
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  width: 100%;
  max-width: 100vw;
}
* {
  box-sizing: border-box;
}

body {
  width: 100%;
  max-width: 100vw;
  overflow-x: hidden;
}

img, canvas, .stats-box, .calc-box, .popup, .position-bar, .trade-box, .tool-box {
  max-width: 100%;
  width: 100%;
}
#bgCandles {
  opacity: 0.035;        /* super dezent */
  filter: blur(0.6px);   /* weiche Kanten */
  pointer-events: none;  /* klickt nicht durch */
}
body {
  --session-bg-color: #111;
  --session-glow: radial-gradient(ellipse at bottom, rgba(100, 0, 150, 0.2) 0%, transparent 70%);

  background-color: var(--session-bg-color);
  color: white;
  font-family: sans-serif;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  width: 100%;
  max-width: 100vw;

  background-image:
    var(--session-glow),
    linear-gradient(0deg, rgba(255,255,255,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
  background-size:
    100% 100%, 
    40px 40px, 
    40px 40px;
  background-repeat: no-repeat;
  background-attachment: fixed;
  animation: bgScroll 40s linear infinite;
}




@keyframes bgScroll {
  0% { background-position: 0 0, 0 0, 0 0; }
  100% { background-position: 400px 400px, 40px 40px, 40px 40px; }
}

/* ğŸ”¥ Session-Spezifische Glow-Farben */
.session-glow-sydney    { --glow-color: #3388ff; background: linear-gradient(145deg, #1e1e1e, #223044); }
.session-glow-tokyo     { --glow-color: #00aaff; background: linear-gradient(145deg, #1e1e1e, #1c2e36); }
.session-glow-london    { --glow-color: #ffd700; background: linear-gradient(145deg, #1e1e1e, #3c3c1a); }
.session-glow-ny        { --glow-color: #ff4500; background: linear-gradient(145deg, #1e1e1e, #3a1e1e); }
.session-glow-lk        { --glow-color: #ccff00; background: linear-gradient(145deg, #1e1e1e, #3c4a1c); }
.session-glow-nyk       { --glow-color: #ff8800; background: linear-gradient(145deg, #1e1e1e, #4b2a1c); }
.session-glow-deadzone  { --glow-color: #333333; background: linear-gradient(145deg, #1e1e1e, #2c2c2c); }
.session-glow-crypto    { --glow-color: #9900ff; background: linear-gradient(145deg, #1e1e1e, #3e1e4e); }

.stats-box {
  padding: 18px 22px;
  border-radius: 16px;
  background: linear-gradient(135deg, #1c1c1c, #262626);
  box-shadow:
    inset 0 1px 2px rgba(255, 255, 255, 0.04),
    0 4px 10px rgba(0, 0, 0, 0.4),
    0 0 14px var(--glow-color, rgba(255, 255, 255, 0.08));
  margin-top: 25px;
  text-align: left;
  max-width: 440px;
  margin-left: auto;
  margin-right: auto;
  transition: box-shadow 0.4s ease, transform 0.3s ease;
  overflow-x: hidden;
  animation: statsGlowPulse 3.5s ease-in-out infinite;
}

@keyframes statsGlowPulse {
  0%   { box-shadow: 0 0 6px var(--glow-color, rgba(255,255,255,0.05)); }
  50%  { box-shadow: 0 0 18px var(--glow-color, rgba(255,255,255,0.25)); }
  100% { box-shadow: 0 0 6px var(--glow-color, rgba(255,255,255,0.05)); }
}





.crypto-animate {
  font-weight: bold;
  font-size: 18px;
  color: #ffffff;
  text-shadow: 0 0 4px #00ffff, 0 0 8px #00ffff, 0 0 16px #ff00cc;
  animation: cryptoGlowPulse 2.4s ease-in-out infinite alternate;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: linear-gradient(90deg, #00ffff, #ff00cc, #9900ff);
  background-size: 300% 300%;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.crypto-animate .coin {
  display: inline-block;
  animation: spinCoin 1.5s linear infinite;
  font-size: 22px;
  color: #ff00cc;
  text-shadow: 0 0 5px #ff00cc, 0 0 12px #ff00cc;
}

@keyframes spinCoin {
  0%   { transform: rotateY(0deg); }
  100% { transform: rotateY(360deg); }
}

@keyframes cryptoGlowPulse {
  0% {
    text-shadow: 0 0 4px #00ffff, 0 0 8px #00ffff, 0 0 12px #ff00cc;
    background-position: 0% 50%;
  }
  100% {
    text-shadow: 0 0 10px #ff00cc, 0 0 20px #ff00cc, 0 0 40px #00ffff;
    background-position: 100% 50%;
  }
}
@keyframes bgScroll {
  from {
    background-position: 0 0;
  }
  to {
    background-position: 40px 40px;
  }
}
/* ğŸ”˜ Toggle-Button fÃ¼r Regelanzeige */
#ruleBox {
  background: linear-gradient(135deg, #1a1a1a, #292929);
  box-shadow: 0 0 8px rgba(0, 255, 153, 0.25);
  border: 1px solid rgba(0, 255, 153, 0.3);
  transition: all 0.3s ease;
  border-radius: 10px;
  padding: 12px 18px;
  color: #00ff99;
  font-weight: bold;
}

#ruleBox:hover {
  box-shadow: 0 0 12px rgba(0, 255, 153, 0.4);
}


/* ğŸ§± Wrapper fÃ¼r Partikel + Glow */
.rules-fire-wrapper {
  position: relative;
  z-index: 0;
  border-radius: 14px;
  overflow: hidden;
  margin-top: 20px;
}

/* ğŸ“œ Regelbox Styling */
#rulesBox {
  background: linear-gradient(135deg, #1a0f0f, #2a1111);
  border: 1px solid #cc3333;
  color: #ff5555;
  text-shadow: 1px 1px 0 #000, -1px -1px 0 #000;
  border-radius: 14px;
  padding: 20px;
  transition: all 0.3s ease;
  line-height: 1.6;
  font-family: 'Segoe UI', Tahoma, sans-serif;
  position: relative;
  z-index: 1;
  animation: redPulse 2.4s ease-in-out infinite alternate,
             fieryGlow 3s ease-in-out infinite alternate;
  box-shadow:
    0 0 10px rgba(255, 50, 50, 0.3),
    0 0 20px rgba(255, 30, 30, 0.2),
    inset 0 0 10px rgba(255, 0, 0, 0.1);
}

/* ğŸ”´ Pulsierender Text */
@keyframes redPulse {
  0% {
    text-shadow: 1px 1px 0 #000, -1px -1px 0 #000, 0 0 2px rgba(255, 0, 0, 0.15);
  }
  100% {
    text-shadow: 1px 1px 0 #000, -1px -1px 0 #000, 0 0 5px rgba(255, 60, 60, 0.25);
  }
}

/* ğŸ”¥ Feuriger Glanz auÃŸen */
@keyframes fieryGlow {
  0% {
    box-shadow:
      0 0 10px rgba(255, 60, 0, 0.3),
      0 0 18px rgba(255, 80, 0, 0.2),
      inset 0 0 10px rgba(255, 0, 0, 0.1);
  }
  100% {
    box-shadow:
      0 0 16px rgba(255, 100, 0, 0.6),
      0 0 32px rgba(255, 150, 0, 0.3),
      inset 0 0 14px rgba(255, 50, 0, 0.25);
  }
}

/* âœ¨ GlÃ¼hpartikel-Overlay */
.fire-particles {
  pointer-events: none;
  position: absolute;
  top: 50%;
  left: 50%;
  width: 6px;
  height: 6px;
  z-index: 3;
  background: radial-gradient(circle, rgba(255, 140, 0, 0.8) 0%, transparent 70%);
  border-radius: 50%;
  animation: fireSparkOut 1.5s linear infinite;
  transform: translate(-50%, -50%);
}

/* ğŸ’¥ Explosionseffekt â€“ Funken nach auÃŸen */
@keyframes fireSparkOut {
  0% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
  100% {
    transform: translate(-200%, -200%) scale(0.4);
    opacity: 0;
  }
}


/* ğŸ“‹ Listen eingerÃ¼ckt */
#rulesBox ul,
#rulesBox ol {
  margin-left: 20px;
  padding-left: 0;
  list-style-position: inside;
}

#rulesBox li {
  padding-left: 8px;
  margin-bottom: 4px;
}

/* ğŸŸ¥ Abschnittstitel schÃ¶ner */
#rulesBox strong {
  display: inline-block;
  margin-top: 10px;
  color: #ff7777;
  text-shadow: 1px 1px 1px #000, 0 0 4px rgba(255, 80, 80, 0.4);
}

/* â– Trenner */
#rulesBox hr {
  border: none;
  border-top: 1px solid rgba(255, 255, 255, 0.08);
  margin: 20px 0;
}

/* â¬…ï¸â¡ï¸ Navigation */
#rulesBox button {
  background: linear-gradient(135deg, #550000, #770000);
  color: white;
  border: 1px solid #000;
  border-radius: 8px;
  padding: 8px 16px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 0 6px rgba(255, 0, 0, 0.4);
  transition: all 0.25s ease;
}

#rulesBox button:hover {
  background: #992222;
  box-shadow: 0 0 10px rgba(255, 60, 60, 0.5);
}





</style>
<link rel="stylesheet" href="mobile.css" media="screen and (max-width: 480px)">

<div class="ticker-box">
  <div id="tickerContent" class="ticker-content">
    ğŸ“¢ Lade Marktdaten...
  </div>
</div>
<canvas id="bgCandles" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1;"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="scripts/position.js"></script>
<script src="scripts/dawn.js"></script>
<script src="scripts/tax.js"></script>
<script src="scripts/bg-candles.js"></script>
<script src="scripts/ticker.js"></script> <!-- ğŸ‘ˆ wichtig -->
<script src="imageStorage.js"></script>



</head>
<body>
<button onclick="showSessionStartNotification('New York', 'ğŸ”¥ NY Session beginnt! Fokus auf Gold & USD!')" style="
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #00aa44;
  color: white;
  border: none;
  padding: 10px 14px;
  border-radius: 8px;
  font-weight: bold;
  box-shadow: 0 0 12px #00ff99;
  z-index: 9999;
">ğŸ”” Session-Test</button>
<button onclick="diagnoseNotifications()" style="
  position: fixed;
  bottom: 60px;
  right: 20px;
  background: #ffaa00;
  color: black;
  border: none;
  padding: 10px 14px;
  border-radius: 8px;
  font-weight: bold;
  box-shadow: 0 0 12px #ffcc00;
  z-index: 9999;
">ğŸ§ª Diagnose</button>

<div id="sessionBackgroundOverlay"></div>
<!-- â±ï¸ Session-Zeit oben prominent -->
<div class="ticker" id="sessionText">Session-Zeit: 00:00</div>


<!-- ğŸ—“ï¸ Tageszusammenfassung -->
<div id="daySummary" class="ticker day-summary">
  ğŸ—“ï¸ Lade Tagesinfo...
</div>
<!-- ğŸ“¦ Session-Details-Box -->
<div class="session-details-box" id="sessionDetailsBox"></div>
<!-- ğŸ“„ Detail-Text zur Tageszusammenfassung -->
<div id="dayDetails" class="day-details" style="display: none;"></div>



<!-- ğŸ’¬ Session-Kommentar (z.â€¯B. flacht ab) -->
<div id="sessionInfo"
     style="margin-top: 12px;
            padding: 12px 18px;
            color: #ffffff;
            font-size: clamp(13px, 3.5vw, 16px);
            font-style: italic;
            text-align: center;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(0, 255, 153, 0.12), rgba(0, 255, 153, 0.22));
            text-shadow: 0 0 2px rgba(0, 255, 153, 0.6), 0 0 6px rgba(0, 255, 153, 0.3);
            box-shadow: inset 0 0 10px rgba(0, 255, 153, 0.3), 0 0 6px rgba(0, 255, 153, 0.2);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: 600;
            backdrop-filter: blur(2px);
            transition: all 0.3s ease;">
  Tipps und Infos zur Session erscheinen hier...
</div>






<!-- ğŸŸ¢ Fortschrittsbalken (zentriert & optisch zugehÃ¶rig) -->
<div class="progress-container">
  <div class="progress-bar" id="progressBar"></div>
</div>



<!-- ğŸš¨ Alerts direkt darunter, aber eher selten sichtbar -->
<div class="alert-below-header" id="alertBox"></div>

<div class="tab-buttons" style="margin-top: 20px; display: flex; flex-wrap: wrap; justify-content: center;">

  <!-- ğŸ“ Position Size â€“ London -->
  <button id="btn-calc-pos" onclick="switchCalcTab('pos')">
    ğŸ“ Position Size
  </button>

  <!-- ğŸŒ’ Dawn Rechner â€“ Tokyo -->
  <button id="btn-calc-dawn" onclick="switchCalcTab('dawn')">
    ğŸŒ’ Dawn Rechner
  </button>

  <!-- ğŸ“„ Steuer / Netto â€“ New York -->
  
  <button id="btn-calc-taxpro" onclick="switchCalcTab('taxpro')">
    ğŸ“„ Steuer / Netto-Planer
  </button>

</div>









<div id="calc-taxpro" class="calc-box" style="margin-top: 15px; display: none;">
  <div class="stats-box">
    <!-- ğŸ” Umschaltbare Ansicht -->
    <div id="steuerMode">
      <label for="gewinnBetrag">ğŸ“ˆ Gesamtgewinn (â‚¬):</label>
      <input type="number" id="gewinnBetrag" placeholder="z.â€¯B. 17200" />

      <label for="einkommenSteuer">ğŸ’¸ Einkommensteuer-Satz (%):</label>
      <input type="number" id="einkommenSteuer" placeholder="z.â€¯B. 25" value="25" step="0.1" />

      <label><input type="checkbox" id="kirchensteuer" /> âœï¸ Kirchensteuer (9â€¯%)</label><br>
      <label><input type="checkbox" id="soliZuschlag" /> ğŸ’£ SolidaritÃ¤tszuschlag (5.5â€¯%)</label><br>
      <label><input type="checkbox" id="reserveZehn" /> ğŸ’¥ +10â€¯% Reserve</label><br>

      <button onclick="berechneSteuern()" class="tax-button">ğŸ“Š Steuer berechnen</button>
      <div id="steuerAusgabe"></div>
    </div>

    <div id="nettoMode" style="display:none">
      <label for="nettoBrutto">ğŸ“ˆ Brutto-Gewinn (â‚¬):</label>
      <input type="number" id="nettoBrutto" placeholder="z.â€¯B. 10000" />

      <label for="nettoSteuer">ğŸ’¸ Steuerlast (â‚¬):</label>
      <input type="number" id="nettoSteuer" placeholder="z.â€¯B. 3500" />

      <label for="nettoEntnommen">ğŸ¦ TatsÃ¤chlich entnommen (â‚¬):</label>
      <input type="number" id="nettoEntnommen" placeholder="z.â€¯B. 8000" />

      <button onclick="berechneNettoPlan()" class="tax-button">ğŸ’¸ Netto berechnen</button>
      <div id="nettoAusgabe"></div>
    </div>

    <!-- ğŸ§  Umschalter -->
    <button onclick="switchPlanMode()" id="planToggleBtn" style="
      margin-top: 15px;
      background: #444;
      color: white;
      padding: 10px;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      width: 100%;
      cursor: pointer;
      font-weight: bold;
    ">
    ğŸ” Zu Netto-Planer wechseln
    </button>
  </div>
</div>




<div id="calc-dawn" class="calc-box" style="display:none; margin-top: 15px;">
  <div class="stats-box">
    <label for="dawnCapital">ğŸ“¦ Startkapital (â‚¬):</label>
    <input type="number" id="dawnCapital" placeholder="z.â€¯B. 1000">

    <label for="dawnLoss">ğŸ“‰ Verlust pro Dawn (%) :</label>
    <input type="number" id="dawnLoss" placeholder="z.â€¯B. 3" step="0.1">

    <button onclick="simulateDawnDeath()" style="
      background: #0077cc;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 10px;
      font-weight: bold;
      margin-top: 12px;
      width: 100%;
      cursor: pointer;
    ">â˜ ï¸ Dawn-Simulation starten</button>

    <p id="dawnDeathResult" style="margin-top: 10px; font-weight: bold; font-size: 16px;"></p>
  </div>
</div>





<div id="calc-pos" class="calc-box" style="margin-top: 15px; display:none;">

  <div class="stats-box">
    <label for="accountSize">ğŸ“¦ KontogrÃ¶ÃŸe (â‚¬):</label>
    <input type="number" id="accountSize" placeholder="z.â€¯B. 1000" />

    <label for="riskPercent">âš ï¸ Risiko in %:</label>
    <input type="number" id="riskPercent" placeholder="z.â€¯B. 1" step="0.1" />

    <label for="stopLossPips">ğŸ›‘ Stop-Loss (in Pips):</label>
    <input type="number" id="stopLossPips" placeholder="z.â€¯B. 20" />

<label for="symbolSelector">ğŸ’± Trading-Paar:</label>
<select id="symbolSelector">
  <optgroup label="ğŸŒ Forex Standard">
    <option value="AUD/USD">AUD/USD</option>
    <option value="EUR/USD">EUR/USD</option>
    <option value="GBP/USD">GBP/USD</option>
    <option value="NZD/USD">NZD/USD</option>
    <option value="USD/CHF">USD/CHF</option>
    <option value="USD/CAD">USD/CAD</option>
  </optgroup>

  <optgroup label="ğŸ’´ Forex Yen-Paare">
    <option value="USD/JPY">USD/JPY</option>
    <option value="EUR/JPY">EUR/JPY</option>
    <option value="GBP/JPY">GBP/JPY</option>
    <option value="CHF/JPY">CHF/JPY</option>
    <option value="AUD/JPY">AUD/JPY</option>
    <option value="NZD/JPY">NZD/JPY</option>
    <option value="CAD/JPY">CAD/JPY</option>
  </optgroup>

  <optgroup label="ğŸ” Cross-Paare">
    <option value="EUR/GBP">EUR/GBP</option>
    <option value="EUR/AUD">EUR/AUD</option>
    <option value="EUR/CAD">EUR/CAD</option>
    <option value="GBP/AUD">GBP/AUD</option>
    <option value="GBP/CAD">GBP/CAD</option>
    <option value="AUD/CAD">AUD/CAD</option>
  </optgroup>

  <optgroup label="ğŸ¥‡ Metalle">
    <option value="XAU/USD">XAU/USD</option>
    <option value="XAG/USD">XAG/USD</option>
  </optgroup>

  <optgroup label="ğŸª™ Krypto">
    <option value="BTC/USD">BTC/USD</option>
    <option value="ETH/USD">ETH/USD</option>
  </optgroup>

  <optgroup label="ğŸ“Š Indizes">
    <option value="US30">US30</option>
    <option value="NAS100">NAS100</option>
    <option value="SPX500">SPX500</option>
    <option value="GER40">GER40</option>
    <option value="UK100">UK100</option>
  </optgroup>
  
</select>

<label for="leverage">âš™ï¸ Hebel:</label>
<input type="number" id="leverage" value="500" min="1" placeholder="z.â€¯B. 500" />




    <button onclick="calculatePositionSize()">ğŸ“ Berechnen</button>
    <p id="positionSizeResult" style="font-weight: bold; font-size: 18px; margin-top: 10px;"></p>
  </div>

  <div style="text-align:right; margin-bottom: 5px;">
    <span onclick="toggleInfoBox()" 
          style="cursor:pointer; background:#444; border-radius:50%; padding:3px 8px; font-weight:bold; color:#0ff;"
          title="ErklÃ¤rung anzeigen">i</span>
  </div>
  <div id="posInfoBox" style="display:none; background:#222; padding:12px; border-radius:8px; margin-top:10px; color:#ccc; font-size:14px; text-align:left;">
    <strong>â„¹ï¸ Was macht dieser Rechner?</strong><br><br>
    Der PositionsgrÃ¶ÃŸen-Rechner hilft dir zu ermitteln, wie viele Lots du in einem Trade einsetzen darfst, ohne mehr als einen bestimmten Prozentsatz deines Kontos zu riskieren. Die Berechnung basiert auf vier Angaben:
    <ul style="margin-top:10px; margin-bottom:10px;">
      <li><strong>ğŸ“¦ KontogrÃ¶ÃŸe:</strong> Dein aktuelles Guthaben in Euro.</li>
      <li><strong>âš ï¸ Risiko in %:</strong> Wie viel Prozent deines Kontos du maximal pro Trade verlieren willst (z.â€¯B. 1%).</li>
      <li><strong>ğŸ›‘ Stop-Loss (Pips):</strong> Die Distanz zwischen Einstieg und Stop-Loss in Pips.</li>
      <li><strong>ğŸ’¡ Pip-Wert pro Lot:</strong> Wie viel ein Pip pro Standard-Lot wert ist (z.â€¯B. 10â€¯â‚¬ bei EUR/USD).</li>
    </ul>
    <strong>ğŸ“ Formel:</strong><br>
    <code style="color:#0ff;">PositionsgrÃ¶ÃŸe = (KontogrÃ¶ÃŸe Ã— Risiko%) / (Stop-Loss Ã— Pip-Wert)</code><br><br>
    <strong>ğŸ” Beispiel:</strong><br>
    KontogrÃ¶ÃŸe: 1000 â‚¬<br>
    Risiko: 2%<br>
    Stop-Loss: 20 Pips<br>
    Pip-Wert: 10 â‚¬/Lot<br><br>
    <strong>â†’</strong> Du riskierst 20 â‚¬ (1000â€¯Ã—â€¯0,02).<br>
    <strong>â†’</strong> Bei 20 Pips wÃ¤ren das 1â€¯â‚¬/Pip erlaubt (20â€¯â‚¬ / 20â€¯Pips).<br>
    <strong>â†’</strong> Der Pip-Wert ist 10â€¯â‚¬/Lot â‡’ <strong>Erlaubte LotgrÃ¶ÃŸe: 0.10</strong><br><br>
    <em style="color:#aaa;">Hinweis: Bei Indizes oder Gold kann der Pip-Wert unterschiedlich sein!</em>
  </div>
</div>



  <!-- ğŸ“† Kalender -->
<div id="journalCalendarBox" class="stats-box" style="margin-top: 20px;">
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <button onclick="changeMonth(-1)">â¬…ï¸</button>
    <h3 id="calendarTitle">ğŸ—“ï¸ Journal-Kalender</h3>
    <button onclick="changeMonth(1)">â¡ï¸</button>
  </div>

  <canvas id="calendarEquityChart" height="150" style="margin:10px auto 5px auto; display:block;"></canvas>

  <div id="calendarEquityStats" style="color: #ccc; margin-top: 5px;"></div>
  <div id="calendarContainer" style="margin-top: 10px;"></div>
  <div id="calendarStats" style="margin-top: 5px; color: #ccc;"></div>
  <div id="journalEntryList" style="margin-top: 0;"></div>
</div>
<!-- âœ… Immer sichtbare Buttons -->
<div style="margin:20px 0; text-align:center;">
  <button onclick="resetCurrentMonth()" style="margin:5px; background:#cc6600; color:white; padding:8px 15px; border:none; border-radius:5px;">ğŸ—“ï¸ Monat zurÃ¼cksetzen</button>
  <button onclick="resetSelectedDay()" style="margin:5px; background:#0066cc; color:white; padding:8px 15px; border:none; border-radius:5px;">ğŸ“… Tag zurÃ¼cksetzen</button>
  <button onclick="resetAllJournal()" style="margin:5px; background:#990000; color:white; padding:8px 15px; border:none; border-radius:5px;">ğŸ—‘ï¸ Alles lÃ¶schen</button>
</div>
<!-- ğŸ“‹ Toggle-Box fÃ¼r deine Trading-Regeln -->
<div class="stats-box" onclick="toggleRules()" style="cursor:pointer;">
  ğŸ“œ <strong>Setup-Regeln anzeigen / ausblenden</strong>
</div>
<div class="rules-fire-wrapper">
<div id="rulesBox" class="stats-box" style="display:none; line-height: 1.6;">
  <strong>Rules Of Rules</strong><br><br>

  <!-- Seite 1 -->
  <div id="rulePage1">
    <strong>ğŸ“ Grundregeln fÃ¼r Entry & Struktur</strong><br><br>

    <strong>AOI-Zone wÃ¤hlen:</strong><br>
    Buy/Sell nur bei Weekly oder Daily AOI<br>
    â†’ Alle Timeframes darunter (4H, 2H, 1H, 30M, 15M) dienen nur zur Entry-BestÃ¤tigung â€“ nicht zur AOI-Bestimmung.<br><br>

    <strong>Kein Entry ohne Rejection von:</strong>
    <ul style="margin-left: 20px;">
      <li>Strukturpunkt</li>
      <li>EMA</li>
      <li>AOI</li>
      <li>Runder psychologischer Level</li>
      <li>Weekly Rejection Candle (auf Weekly oder Daily sichtbar)</li>
    </ul><br>

    <strong>Buy/Sell Entry-Bedingung:</strong>
    <ul style="margin-left: 20px;">
      <li>4H Higher Low (HL) fÃ¼r Buy</li>
      <li>4H Lower High (LH) fÃ¼r Sell</li>
      <li>Oder potenzieller HL/LH mit Engulfing an AOI (Support/Resistance)</li>
    </ul><br>

    <strong>Entry-Prozess nach HL/LH:</strong><br>
    Moderation der 15Mâ€“1H Struktur-Shift, um Entry mit dem hÃ¶heren Timeframe abzustimmen.<br>
    Der sauberste Shift dominiert (welcher TF am klarsten ist)<br><br>

    <strong>Nach Shift auf 15M, 30M, 1H:</strong>
    <ul style="margin-left: 20px;">
      <li>Suche nach Engulfing Candle auf:</li>
      <li>1H</li>
      <li>2H</li>
      <li>4H (je nach Klarheit/Confirmation)</li>
      <li>Je hÃ¶her der Timeframe â†’ desto stÃ¤rker die BestÃ¤tigung</li>
    </ul><br>

    <strong>âš ï¸ Stop-Loss-Regel:</strong><br>
    SL muss immer an dem Punkt liegen, wo die Idee komplett falsch ist.<br>
    Niemals "mal probieren" â€“ SL = klare Grenze der GÃ¼ltigkeit.<br><br>

    <strong>ğŸ¯ Take-Profit-Regel:</strong>
    <ul style="margin-left: 20px;">
      <li>Wenn Buy/Sell an Weekly AOI mit Ziel Weekly HH/LL:<br> â†’ TP1 = Strukturpunkt (nur KerzenkÃ¶rper zÃ¤hlen)</li>
      <li>Wenn Buy/Sell an Daily AOI mit Ziel Daily HH/LL:<br> â†’ TP1 = Strukturpunkt (nur KerzenkÃ¶rper zÃ¤hlen)</li>
    </ul>
  </div>

  <!-- Seite 2 -->
  <div id="rulePage2" style="display:none;">
  <strong>ğŸ“˜ Confluence Short / Long Regelwerk</strong><br><br>

  <strong>1. Markt-Bias Bewertung:</strong><br>
  <ul style="margin-left: 20px;">
    <li>â€¢ Weekly Bullish/Bearish: 1 â€“ 3</li>
    <li>â€¢ Daily Bullish/Bearish: 1 â€“ 3</li>
    <li>â€¢ 4H Bullish/Bearish: 1 â€“ 3</li>
  </ul>

  <strong>1.1 Bedeutung der Bewertungsstufen:</strong><br>
  <ul style="margin-left: 20px;">
    <li>â€¢ 1 = Oben (On the Top)</li>
    <li>â€¢ 2 = Auf dem Weg zur AOI</li>
    <li>â€¢ 3 = In der AOI</li>
  </ul><hr>

  <strong>2. Struktur-Retest (HTF):</strong><br>
  <ul style="margin-left: 20px;">
    <li>â€¢ Weekly retestet vorherigen Strukturpunkt</li>
  </ul><hr>

  <strong>3. Daily Rejection (BestÃ¤tigung):</strong><br>
  <ul style="margin-left: 20px;">
    <li>â€¢ 1: Rejection an AOI</li>
    <li>â€¢ 2: Rejection an rundem psychologischen Level (00 / 50)</li>
  </ul><hr>

  <strong>4. Strukturaufbau (LTF):</strong><br>
  <ul style="margin-left: 20px;">
    <li>â€¢ Warten auf Higher Low / Lower High (HL / LH)</li>
    <li>â€¢ Struktur-Shift auf: 15M / 30M / 1H</li>
  </ul><hr>

  <strong>5. Entry Signal BestÃ¤tigung:</strong><br>
  <ul style="margin-left: 20px;">
    <li>â€¢ BestÃ¤tigung durch bullische/bÃ¤rische Candle-Formationen auf: 1H / 2H / 4H</li>
  </ul><hr>

  <strong>6. Set and Forget:</strong><br>
  <ul style="margin-left: 20px;">
    <li>â€¢ Nach Entry nicht mehr eingreifen.</li>
    <li>â€¢ Vertrauen in das Setup. Kein Nachjustieren.</li>
  </ul>

<div class="fire-sparks"></div>


  </div>

  <!-- Navigation -->
  <div style="margin-top: 20px; display: flex; justify-content: space-between;">
    <button onclick="showPage(1)" id="prevPageBtn" style="display:none;">â¬…ï¸ ZurÃ¼ck</button>
    <button onclick="showPage(2)" id="nextPageBtn">Weiter â¡ï¸</button>
  </div>
 <div class="fire-particles"></div>
</div>


<!-- ğŸ“˜ Journal-Eingabe -->
<div id="calc-journal" class="calc-box" style="display:none; margin-top: 10px;">
  <div class="stats-box journal-box">


    <label>ğŸ§­ Strategie-Modus:</label>
    <select id="tradingMode" onchange="updateBiasOptions()" class="input" style="width: 100%;">

      <option value="day">Daytrading</option>
      <option value="swing">Swing-Trading</option>
    </select>

    <label>ğŸ“† Datum:</label>
    <input type="date" id="journalManualDate" class="input" style="width: 100%;" />

    <label>ğŸ’± Symbol:</label>
    <input type="text" id="journalSymbol" class="input" placeholder="z.â€¯B. EUR/USD" oninput="suggestSymbol()" autocomplete="off" style="width: 100%;" />
    <div id="symbolSuggestions" style="background:#222; color:white; padding:5px; display:none; border-radius:6px;"></div>

<!-- Einstieg + Ausstieg + Richtung -->
<div style="display: flex; gap: 10px; flex-wrap: wrap;">
  <div style="flex: 1; min-width: 130px;">
    <label>ğŸ¯ Einstieg:</label>
    <input type="number" id="journalEntry" class="input" style="width: 100%;" onchange="autoSuggestExit()" />
  </div>
  <div style="flex: 1; min-width: 130px;">
    <label>Richtung:</label>
    <select id="journalDirection" class="input" onchange="autoSuggestExit()">
      <option value="long">ğŸ“ˆ Long</option>
      <option value="short">ğŸ“‰ Short</option>
    </select>
  </div>
</div>


  <div style="display: flex; flex-direction: column; gap: 10px;">
<div>
  <label>ğŸ“¦ LotgrÃ¶ÃŸe:</label>
  <select id="journalLots" class="input" style="width: 100%; background-color: white; color: black;">
    <option value="">â€“ Bitte wÃ¤hlen â€“</option>
    <option value="0.01">0.01</option>
    <option value="0.02">0.02</option>
    <option value="0.03">0.03</option>
    <option value="0.05">0.05</option>
    <option value="0.10">0.10</option>
    <option value="0.25">0.25</option>
    <option value="0.50">0.50</option>
    <option value="1.00">1.00</option>
    <option value="2.00">2.00</option>
    <option value="3.00">3.00</option>
    <option value="5.00">5.00</option>
    <option value="10.00">10.00</option>
    <option value="25.00">25.00</option>
    <option value="50.00">50.00</option>
    <option value="100.00">100.00</option>
  </select>
</div>


  <div>
    <label>ğŸ“Š PnL (â‚¬):</label>
<input type="text"
       id="journalPnL"
       class="input"
       placeholder="z.â€¯B. -50.00"
       inputmode="numeric"
       pattern="^-?[0-9]+([.,][0-9]{1,2})?$"
       style="width: 100%; background-color: white; color: black;" />


  </div>
</div>


  <div class="emotion-block">
  <label>ğŸ˜ Fokus <strong>vor</strong> dem Trade:</label>
  <div id="starsBefore" class="star-rating"></div>
  <input type="hidden" id="emotionBefore" value="5" />
</div>

<div class="emotion-block">
  <label>ğŸ˜¤ Emotion <strong>nach</strong> dem Trade:</label>
  <div id="starsAfter" class="star-rating"></div>
  <input type="hidden" id="emotionAfter" value="5" />
</div>


    <label>ğŸ§  Setup:</label>
<select id="journalSetup" class="input" style="width: 100%;">
  <option value="">â€“ Setup wÃ¤hlen â€“</option>
  <option value="Rejectiont">Rejection</option>
  <option value="Breakout + Rejection">Breakout + Rejection</option>
  <option value="Liquidity Grab">Liquidity Grab</option>
  <option value="Shift">Shift HTF/LTF</option>
  <option value="HH HL LH LL">HH HL LH LL</option>
</select>

<!-- ğŸ§± Setup-Box Start -->
<div id="setupBoxWrapper"
  style="margin-top: 10px; border-radius: 12px; padding: 16px;
         background: linear-gradient(135deg, #3d1e1e, #6b2f2f);
         border: 2px solid #aa3333;
         color: #eee;
         box-shadow: 0 0 8px rgba(255, 50, 50, 0.25);
         transition: all 0.3s ease;">

  <label style="font-weight: bold; font-size: 16px; display: block; margin-bottom: 10px; color: #f0f0f0; text-shadow: 1px 1px 2px black;">
    âœ… Setup-Check
  </label>

  <label style="margin-top: 5px; color: #f0f0f0; text-shadow: 1px 1px 2px black;">ğŸ§­ Multi-Timeframe Bias:</label>
  <div id="biasTimeframes" style="display: flex; flex-wrap: wrap; gap: 10px; font-size: 14px; color: #eeeeee; text-shadow: 1px 1px 2px black;">
    <label><input type="checkbox" value="15M" onchange="updateSetupScoreDisplay()" /> 15M</label>
    <label><input type="checkbox" value="30M" onchange="updateSetupScoreDisplay()" /> 30M</label>
    <label><input type="checkbox" value="1H" onchange="updateSetupScoreDisplay()" /> 1H</label>
    <label><input type="checkbox" value="4H" onchange="updateSetupScoreDisplay()" /> 4H</label>
    <label><input type="checkbox" value="D1" onchange="updateSetupScoreDisplay()" /> D1</label>
    <label><input type="checkbox" value="W1" onchange="updateSetupScoreDisplay()" /> W1</label>
  </div>

  <div id="ruleChecklist" style="display: flex; flex-direction: column; gap: 10px; font-size: 14px; margin-top:10px; color: #eeeeee; text-shadow: 1px 1px 2px black;">
    <label><input type="checkbox" id="ruleAOI" onchange="updateSetupScoreDisplay()" />
      ğŸ§± AOI / POI reagiert sichtbar
    </label>
    <small style="margin-left: 20px; color:#dddddd; text-shadow: 1px 1px 1px black;">
      â–¶ Preis reagiert klar in AOI&POI (z.â€¯B. W, D1)
    </small>

    <label><input type="checkbox" id="ruleEntry" onchange="updateSetupScoreDisplay()" />
      ğŸ¯ Entry-Trigger bestÃ¤tigt
    </label>
    <small style="margin-left: 20px; color:#dddddd; text-shadow: 1px 1px 1px black;">
      â–¶ Rejection, Equal High/Low Raid, Shift
    </small>

    <label><input type="checkbox" id="ruleEntryPattern" onchange="updateSetupScoreDisplay()" />
      ğŸ§  Einstiegsmuster sichtbar
    </label>
    <small style="margin-left: 20px; color:#dddddd; text-shadow: 1px 1px 1px black;">
      â–¶ z.â€¯B. Inside Bar, Morning Star, Pinbar, Engulfing, Quasimodo
    </small>

    <label><input type="checkbox" id="rulePsych" onchange="updateSetupScoreDisplay()" />
      ğŸ’¡ Psychologisches Level
    </label>
    <small style="margin-left: 20px; color:#dddddd; text-shadow: 1px 1px 1px black;">
      â–¶ 00/50-Level, Vorwochen-Hoch/Tief, runde Zahlen (z.â€¯B. 1900, 1950)
    </small>

    <label><input type="checkbox" id="ruleSession" onchange="updateSetupScoreDisplay()" />
      ğŸ•’ Richtiges Zeitfenster
    </label>
    <small style="margin-left: 20px; color:#dddddd; text-shadow: 1px 1px 1px black;">
      â–¶ Killzones: London (08:00â€“11:00), New York (14:30â€“17:00), Asia (02:00â€“04:00)
    </small>

    <label><input type="checkbox" id="ruleRR" onchange="updateSetupScoreDisplay()" />
      ğŸ“ Minimum 1:2.5 RR
    </label>
    <small style="margin-left: 20px; color:#dddddd; text-shadow: 1px 1px 1px black;">
      â–¶ Laut Struktur realistisch erreichbares Ziel: â‰¥ 2,5x SL-Distanz
    </small>

    <label><input type="checkbox" id="ruleLTFShift" onchange="updateSetupScoreDisplay()" />
      ğŸ” LTF Strukturwechsel (Shift)
    </label>
    <small style="margin-left: 20px; color:#dddddd; text-shadow: 1px 1px 1px black;">
      â–¶ MSS auf 15M - 2H â†’ z.â€¯B. HL â†’ HH â†’ LL
    </small>

    <div id="setupScoreDisplay" style="margin-top: 12px; font-size: 14px; font-weight: bold; color: #f0f0f0; text-shadow: 1px 1px 2px black;">
      ğŸ“Š Setup-Score: <strong>0%</strong> â€“ âŒ Nicht gÃ¼ltig
    </div>
  </div> <!-- âœ… Ende der Regel-Checkliste-Box -->

</div> <!-- âœ… Ende setupBoxWrapper -->

<!-- ğŸ”» Jetzt alles auÃŸerhalb der Box -->
<div style="margin-top: 20px; font-size: 14px; color: #eeeeee; text-shadow: 1px 1px 2px black;">

  <label>ğŸ“ Kommentar <strong>vor dem Trade</strong>:</label>
  <textarea id="journalNotesBefore" rows="2" class="input" style="border-radius: 6px; width: 100%; margin-bottom: 10px;"></textarea>

  <label>ğŸ“ Kommentar <strong>nach dem Trade</strong>:</label>
  <textarea id="journalNotesAfter" rows="2" class="input" style="border-radius: 6px; width: 100%; margin-bottom: 10px;"></textarea>

  <label for="screenshotInput">ğŸ“¸ Screenshots hochladen (optional):</label>
  <input type="file" id="screenshotInput" accept="image/*" multiple class="input" style="margin-bottom: 15px;" />

  <button id="saveJournalEntryButton" onclick="saveJournalEntry()" style="
    background-color: #0077cc;
    color: white;
    padding: 14px;
    border: none;
    border-radius: 8px;
    margin-top: 10px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    width: 100%;
  ">ğŸ’¾ Eintrag speichern</button>
</div>




<div id="lightboxOverlay" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); justify-content:center; align-items:center; z-index:9999;" onclick="closeLightbox()">
  <img id="lightboxImage" src="" alt="Bild" style="max-width:90vw; max-height:90vh; border-radius:10px; box-shadow: 0 0 20px #000;" />
</div>

<!-- ğŸ” Lightbox fÃ¼r vergrÃ¶ÃŸerte Bilder -->
<div id="lightboxOverlay" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.8); justify-content:center; align-items:center; z-index:9999;" onclick="closeLightbox()">
  <img id="lightboxImage" src="" alt="Full Screenshot" style="max-width:90vw; max-height:90vh; border-radius:10px; box-shadow: 0 0 20px #000;" />
</div>



<div class="popup" id="resultPopup">
  <h3>Ergebnis</h3>
  <input type="text" inputmode="decimal" id="pnlInput" placeholder="z.â€¯B. 120.50" value="00,00" />
  <button onclick="saveResult()">Speichern</button>
</div>


<body>
<script src="scripts/pwa.js"></script>

<script src="scripts/session-popup.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="scripts/session.js"></script>
<script src="scripts/buttons.js"></script>
<script src="scripts/screen.js"></script>
<script src="scripts/background-session.js"></script>
<script src="scripts/position.js"></script>
<script src="scripts/dawn.js"></script>
<script src="scripts/tax.js"></script>
<script src="imageStorage.js"></script>
<script src="scripts/bg-candles.js"></script>
<script src="scripts/ticker.js"></script>
<script src="scripts/jornal.js"></script>
<script src="scripts/pwa.js"></script>
<script src="scripts/rules.js"></script>
<script type="module" src="pocketbase-init.js"></script>

</body>

</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>







</html>
