<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trade App Layout</title>

  <!-- ğŸ”— External stylesheets (lassen wir wie im Original) -->
  <link rel="stylesheet" href="CSS/ticker.css" />
  <link rel="stylesheet" href="CSS/star.css" />
  <link rel="stylesheet" href="CSS/session.css" />
  <link rel="stylesheet" href="CSS/Rechner.css" />
  <link rel="stylesheet" href="CSS/rules.css" />
  <link rel="stylesheet" href="CSS/jornal.css" />

  <!-- PWA / Manifest -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#00aa44" />

  <style>
    /* ==========================================
       ğŸ¯ GLOBAL BASICS + VARIABLES
       - Ziel: Ordnung, saubere Defaults, keine Duplikate
       ========================================== */
    :root {
      /* Basisfarben / Defaults */
      --color-bg: #111;
      --color-fg: #fff;

      /* Session-Glow (Fallback) */
      --session-bg-color: var(--color-bg);
      --session-glow: radial-gradient(
        ellipse at bottom,
        rgba(100, 0, 150, 0.2) 0%,
        transparent 70%
      );

      /* Box-Glow Fallback */
      --glow-color: rgba(255, 255, 255, 0.08);

      /* Grid-Lines (dezentes Raster im Hintergrund) */
      --grid-line-color: rgba(255, 255, 255, 0.03);

      /* Crypto-Gradient Farben */
      --crypto-c1: #00ffff;
      --crypto-c2: #ff00cc;
      --crypto-c3: #9900ff;

      /* Timing / Durations */
      --bg-scroll-duration: 40s;
      --stats-glow-duration: 3.5s;
      --crypto-gradient-duration: 6s;
      --crypto-pulse-duration: 2.8s;
      --coin-rotate-duration: 1.5s;
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      max-width: 100vw;
      overflow-x: hidden;
      box-sizing: border-box;
    }

    *, *::before, *::after { box-sizing: inherit; }

    /* ==========================================
       ğŸ§± PAGE BACKGROUND & TYPO
       ========================================== */
 body {
  --session-bg-color: #111;
  --session-glow: radial-gradient(ellipse at bottom, rgba(100, 0, 150, 0.2) 0%, transparent 70%);

  background-color: var(--session-bg-color);
  color: white;
  font-family: sans-serif;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  width: 100%;
  max-width: 100vw;

  background-image:
    var(--session-glow),
    linear-gradient(0deg, rgba(255,255,255,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
  background-size:
    100% 100%, 
    40px 40px, 
    40px 40px;
  background-repeat: no-repeat;
  background-attachment: fixed;
  animation: bgScroll 40s linear infinite;
}

    /* dezente, animierte Rasterbewegung */
    @keyframes bgScroll {
      0%   { background-position: 0 0, 0 0, 0 0; }
      100% { background-position: 400px 400px, 40px 40px, 40px 40px; }
    }

    /* Canvas fÃ¼r leichten Candle-Hintergrund */
    #bgCandles {
      opacity: 0.035;         /* super dezent */
      filter: blur(0.6px);    /* weiche Kanten */
      pointer-events: none;   /* klickt nicht durch */
      max-width: 100%;
      width: 100%;
      display: block;
    }




/* â™¿ Bewegungen reduzieren, wenn gewÃ¼nscht */
@media (prefers-reduced-motion: reduce) {
  body { animation: none !important; }
}


/* =========================================================
   ğŸ“¦ .stats-box â€” Deep Velvet Luxe
   ========================================================= */
.stats-box {
  /* Theme hooks */
  --velvet-top: #131116;
  --velvet-mid: #141219;
  --velvet-bot: #0f0d12;
  --accent: var(--glow-color, #f3d27a);

  position: relative;
  max-width: 440px;
  margin: 25px auto 0 auto;
  padding: 20px 22px;
  border-radius: 16px;
  text-align: left;
  overflow: hidden;
  isolation: isolate;

  /* Samtiger Tiefenverlauf */
  background:
    radial-gradient(140% 120% at 50% -10%, rgba(255,255,255,0.05), transparent 55%),
    linear-gradient(180deg, var(--velvet-top), var(--velvet-mid) 55%, var(--velvet-bot));
  border: 1px solid rgba(255,255,255,0.04);

  /* Weiche Schatten + Accent-Glow */
  box-shadow:
    0 10px 26px rgba(0,0,0,0.55),
    0 0 16px color-mix(in srgb, var(--accent) 18%, transparent),
    inset 0 1px 2px rgba(255,255,255,0.04);

  /* Dezentes Aufleuchten (GPUâ€‘freundlich) */
  animation: statsGlowPulse var(--stats-glow-duration, 3.5s) ease-in-out infinite;
  transition: box-shadow 240ms ease, opacity 240ms ease;
}

/* Subtile Velvet-Struktur */
.stats-box::before {
  content: "";
  position: absolute; inset: 0;
  z-index: 0; pointer-events: none;
  background:
    repeating-linear-gradient(135deg, rgba(255,255,255,0.015) 0 1px, transparent 1px 8px),
    repeating-linear-gradient(45deg,  rgba(0,0,0,0.025) 0 1px, transparent 1px 10px);
  mix-blend-mode: overlay;
  opacity: 0.6;
}

/* Elegante Gold-/Sessionkante als weicher Innen-Glow */
.stats-box::after {
  content: "";
  position: absolute; inset: 0;
  z-index: 1; pointer-events: none; border-radius: inherit;
  box-shadow:
    inset 0 0 0 1px color-mix(in srgb, var(--accent) 55%, transparent),
    inset 0 0 24px color-mix(in srgb, var(--accent) 22%, transparent),
    0 0 22px color-mix(in srgb, var(--accent) 18%, transparent);
  opacity: 0.22;
  transition: opacity 240ms ease;
  animation: luxeRingPulse var(--stats-glow-duration, 3.5s) ease-in-out infinite;
}

/* Pulse: nur Schatten/Opacity */
@keyframes statsGlowPulse {
  0% {
    box-shadow:
      0 10px 26px rgba(0,0,0,0.55),
      0 0 14px color-mix(in srgb, var(--accent) 14%, transparent),
      inset 0 1px 2px rgba(255,255,255,0.04);
  }
  50% {
    box-shadow:
      0 12px 30px rgba(0,0,0,0.6),
      0 0 22px color-mix(in srgb, var(--accent) 26%, transparent),
      inset 0 1px 3px rgba(255,255,255,0.05);
  }
  100% {
    box-shadow:
      0 10px 26px rgba(0,0,0,0.55),
      0 0 14px color-mix(in srgb, var(--accent) 14%, transparent),
      inset 0 1px 2px rgba(255,255,255,0.04);
  }
}

@keyframes luxeRingPulse {
  0%   { opacity: 0.20; }
  50%  { opacity: 0.34; }
  100% { opacity: 0.20; }
}

/* â™¿ Bewegungs-Reduktion */
@media (prefers-reduced-motion: reduce) {
  .stats-box,
  .stats-box::after { animation: none !important; }
}


    /* ==========================================
       ğŸ”¥ SESSION-SPEZIFISCHE THEMES
       - setzen jeweils --glow-color + Hintergrund-Gradient
       ========================================== */
    .session-glow-sydney    { --glow-color: #3388ff; background: linear-gradient(145deg, #1e1e1e, #223044); }
    .session-glow-tokyo     { --glow-color: #00aaff; background: linear-gradient(145deg, #1e1e1e, #1c2e36); }
    .session-glow-london    { --glow-color: #ffd700; background: linear-gradient(145deg, #1e1e1e, #3c3c1a); }
    .session-glow-ny        { --glow-color: #ff4500; background: linear-gradient(145deg, #1e1e1e, #3a1e1e); }
    .session-glow-lk        { --glow-color: #ccff00; background: linear-gradient(145deg, #1e1e1e, #3c4a1c); }
    .session-glow-nyk       { --glow-color: #ff8800; background: linear-gradient(145deg, #1e1e1e, #4b2a1c); }
    .session-glow-deadzone  { --glow-color: #333333; background: linear-gradient(145deg, #1e1e1e, #2c2c2c); }
    .session-glow-crypto    { --glow-color: #9900ff; background: linear-gradient(145deg, #1e1e1e, #3e1e4e); }



    /* ==========================================
       ğŸŒˆ CRYPTO LABEL â€“ animierter Text + Coin
       ========================================== */
    .crypto-animate {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: bold;
      font-size: 18px;
      background: linear-gradient(90deg, var(--crypto-c1), var(--crypto-c2), var(--crypto-c3), var(--crypto-c1));
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow:
        0 0 6px rgba(0,255,255,0.8),
        0 0 12px rgba(255,0,204,0.6),
        0 0 20px rgba(153,0,255,0.4);
      animation: cryptoGradientShift var(--crypto-gradient-duration) ease infinite,
                 cryptoGlowPulse var(--crypto-pulse-duration) ease-in-out infinite;
    }

    .crypto-animate .coin {
      display: inline-block;
      font-size: 22px;
      background: linear-gradient(90deg, #ff00cc, #ff8800, #ffff00);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 8px rgba(255,0,204,0.8);
      animation: spinCoin var(--coin-rotate-duration) linear infinite;
    }

    @keyframes spinCoin {
      0%   { transform: rotateY(0deg); }
      100% { transform: rotateY(360deg); }
    }

    @keyframes cryptoGradientShift {
      0%   { background-position: 0% 50%; }
      50%  { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    @keyframes cryptoGlowPulse {
      0% {
        text-shadow:
          0 0 6px rgba(0,255,255,0.8),
          0 0 12px rgba(255,0,204,0.6),
          0 0 20px rgba(153,0,255,0.4);
      }
      100% {
        text-shadow:
          0 0 10px rgba(255,0,204,0.9),
          0 0 18px rgba(0,255,255,0.7),
          0 0 30px rgba(153,0,255,0.5);
      }
    }

    


    /* ==========================================
       â™¿ Optional: Bewegt sich weniger, wenn Nutzer es wÃ¼nscht
       ========================================== */
    @media (prefers-reduced-motion: reduce) {
      body { animation: none; }
      .stats-box, .crypto-animate, .crypto-animate .coin { animation: none; }
    }
  </style>
<!-- ğŸ“± Mobile Stylesheet -->
<link rel="stylesheet" href="mobile.css" media="screen and (max-width: 480px)">

<!-- ğŸ“¢ Ticker -->
<div class="ticker-box">
  <div id="tickerContent" class="ticker-content">
    ğŸ“¢ Lade Marktdaten...
  </div>
</div>

<!-- ğŸ“Š Hintergrund-Candles -->
<canvas id="bgCandles"
        style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1;">
</canvas>

<!-- ğŸ“š Scripts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="scripts/position.js"></script>
<script src="scripts/dawn.js"></script>
<script src="scripts/tax.js"></script>
<script src="scripts/bg-candles.js"></script>
<script src="scripts/ticker.js"></script> <!-- ğŸ‘ˆ wichtig -->
<script src="imageStorage.js"></script>

</head>
<body>



<!-- ğŸ¨ Session-Hintergrund -->
<div id="sessionBackgroundOverlay"></div>

<!-- ğŸ•’ Session-Zeit -->
<div class="ticker" id="sessionText">Session-Zeit: 00:00</div>

<!-- ğŸ—“ï¸ Tageszusammenfassung -->
<div id="daySummary" class="ticker day-summary">ğŸ—“ï¸ Lade Tagesinfo...</div>

<!-- ğŸ“¦ Session-Details -->
<div class="session-details-box" id="sessionDetailsBox"></div>

<!-- ğŸ“„ Detail-Text zur Tageszusammenfassung -->
<div id="dayDetails" class="day-details" style="display: none;"></div>

<!-- ğŸ’¬ Session-Kommentar -->
<div id="sessionInfo"
     style="margin-top: 12px; padding: 12px 18px; color: #fff;
            font-size: clamp(13px, 3.5vw, 16px); font-style: italic; text-align: center;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(153, 0, 255, 0.12), rgba(153, 0, 255, 0.22));
            text-shadow: 0 0 2px rgba(153, 0, 255, 0.6), 0 0 6px rgba(255, 0, 204, 0.3);
            box-shadow: inset 0 0 10px rgba(153, 0, 255, 0.3), 0 0 6px rgba(255, 0, 204, 0.2);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600;
            backdrop-filter: blur(2px); transition: all 0.3s ease;">
  Tipps und Infos zur Session erscheinen hier...
</div>


<!-- ğŸŸ¢ Fortschrittsbalken -->
<div class="progress-container">
  <div class="progress-bar" id="progressBar"></div>
</div>

<!-- ğŸš¨ Alerts -->
<div class="alert-below-header" id="alertBox"></div>

<!-- ğŸ”˜ Tab-Buttons -->
<div class="tab-buttons" style="margin-top: 20px; display: flex; flex-wrap: wrap; justify-content: center;">
  <button id="btn-calc-pos" onclick="switchCalcTab('pos')">ğŸ“ Position Size</button>
  <button id="btn-calc-dawn" onclick="switchCalcTab('dawn')">ğŸŒ’ Dawn Rechner</button>
  <button id="btn-calc-taxpro" onclick="switchCalcTab('taxpro')">ğŸ“„ Steuer / Netto-Planer</button>
</div>

<!-- ğŸ“„ Steuer-/Netto-Planer -->
<div id="calc-taxpro" class="calc-box" style="margin-top: 15px; display: none;">
  <div class="stats-box">

    <!-- ğŸ’¼ Jahresgehalt -->
    <label for="jahresEinkommen">ğŸ’¼ Jahresgehalt (9/5 Job, brutto â‚¬):</label>
    <input type="number" id="jahresEinkommen" placeholder="z. B. 42000">

    <!-- ğŸ’° Steuer-Berechnung -->
    <div id="steuerMode">
      <label for="gewinnBetrag">ğŸ“ˆ Trading-Gewinn (aktueller Gewinn â‚¬):</label>
      <input type="number" id="gewinnBetrag" placeholder="z. B. 500">

      <label><input type="checkbox" id="kirchensteuer"> âœï¸ Kirchensteuer (9 %)</label><br>
      <label><input type="checkbox" id="soliZuschlag"> ğŸ’£ SolidaritÃ¤tszuschlag (5.5 %)</label><br>
<label><input type="checkbox" id="reserveZehn"> ğŸ’¥ Komplette Vorauszahlung fÃ¼r nÃ¤chstes Jahr</label><br>


      <button onclick="berechneSteuern()" class="tax-button">ğŸ“Š Steuer berechnen</button>
      <div id="steuerAusgabe"></div>
    </div>

<!-- ğŸ¦ Netto-Planer -->
<div id="nettoMode" style="display:none">
  <label for="nettoBrutto">ğŸ“ˆ Brutto-Gewinn (â‚¬):</label>
  <input type="number" id="nettoBrutto" placeholder="z. B. 1000">

  <label for="nettoSteuer">ğŸ’¸ Steuerlast (â‚¬):</label>
  <input type="number" id="nettoSteuer" placeholder="z. B. 350">

  <label for="nettoReserve">ğŸ’¥ Reserve (â‚¬):</label>
  <input type="number" id="nettoReserve" placeholder="z. B. 250">

  <label for="nettoEntnommen">ğŸ¦ TatsÃ¤chlich entnommen (â‚¬):</label>
  <input type="number" id="nettoEntnommen" placeholder="z. B. 800">

  <button onclick="berechneNettoPlan()" class="tax-button">ğŸ’¸ Netto berechnen</button>
  <div id="nettoAusgabe"></div>
</div>


    <!-- ğŸ“Š Trades -->
    <div id="tradeTable" style="margin-top:20px;"></div>

    <!-- ğŸ”„ Umschalter -->
<button onclick="switchPlanMode()" id="planToggleBtn">
  ğŸ” Zu Netto-Planer wechseln
</button>

  </div>
</div>




<!-- â˜ ï¸ Dawn Rechner -->
<div id="calc-dawn" class="calc-box" style="display:none; margin-top: 15px;">
  <div class="stats-box">
    <label for="dawnCapital">ğŸ“¦ Startkapital (â‚¬):</label>
    <input type="number" id="dawnCapital" placeholder="z. B. 1000">

    <label for="dawnLoss">ğŸ“‰ Verlust pro Dawn (%) :</label>
    <input type="number" id="dawnLoss" placeholder="z. B. 3" step="0.1">

    <button onclick="simulateDawnDeath()"
            style="background: #0077cc; color: white; border: none; border-radius: 6px;
                   padding: 10px; font-weight: bold; margin-top: 12px; width: 100%;
                   cursor: pointer;">
      â˜ ï¸ Dawn-Simulation starten
    </button>

    <p id="dawnDeathResult" style="margin-top: 10px; font-weight: bold; font-size: 16px;"></p>
  </div>
</div>

<!-- ğŸ“ Positionstab -->
<div id="calc-pos" class="calc-box" style="margin-top:15px; display:none;">

  <!-- Normaler PositionsgrÃ¶ÃŸenrechner -->
  <div id="pos-mode-main" class="stats-box sub-box" style="display:block;">
    <label for="accountSize">ğŸ“¦ KontogrÃ¶ÃŸe (â‚¬):</label>
    <input type="number" id="accountSize" placeholder="z. B. 1000">

    <label for="riskPercent">âš ï¸ Risiko in %:</label>
    <input type="number" id="riskPercent" placeholder="z. B. 1" step="0.1">

    <label for="stopLossPips">ğŸ›‘ Stop-Loss (in Pips):</label>
    <input type="number" id="stopLossPips" placeholder="z. B. 20">

    <label for="symbolSelector">ğŸ’± Trading-Paar:</label>
    <select id="symbolSelector"></select>

    <label for="leverage">âš™ï¸ Hebel:</label>
    <input type="number" id="leverage" value="500" min="1">

    <button onclick="calculatePositionSize()">ğŸ“ Berechnen</button>
    <!-- Ergebnis-Box -->
    <div id="positionSizeResult" class="result-box"></div>

    <!-- Umschalter -->
    <button onclick="switchPosMode('max')" style="margin-top:15px; width:100%;">ğŸ” Zu Max-Positions-Rechner</button>
    <button onclick="switchPosMode('pips')" style="margin-top:10px; width:100%;">ğŸ” Zu Pip-Rechner</button>
  </div>

  <!-- Max Positions Rechner -->
  <div id="pos-mode-max" class="stats-box sub-box" style="display:none;">
    <label for="maxposAccountSize">ğŸ“¦ KontogrÃ¶ÃŸe (â‚¬):</label>
    <input type="number" id="maxposAccountSize" placeholder="z. B. 1000">

    <label for="maxposRiskPercent">âš ï¸ Risiko in % pro Trade:</label>
    <input type="number" id="maxposRiskPercent" placeholder="z. B. 1" step="0.1">

    <label for="maxposStopLoss">ğŸ›‘ Stop-Loss (in Pips):</label>
    <input type="number" id="maxposStopLoss" placeholder="z. B. 20">

    <label for="maxposLeverage">âš™ï¸ Hebel:</label>
    <input type="number" id="maxposLeverage" value="500" min="1">

    <label>ğŸ“ LotgrÃ¶ÃŸe von:</label>
    <input type="number" id="lotFrom" step="0.01">

    <label>ğŸ“ LotgrÃ¶ÃŸe bis:</label>
    <input type="number" id="lotTo" step="0.01">

    <button onclick="calculateMaxPositions()">ğŸ“ Berechnen</button>
    <!-- Ergebnis-Box -->
    <div id="maxposResults" class="result-box"></div>

    <button onclick="switchPosMode('main')" style="margin-top:15px; width:100%;">ğŸ” ZurÃ¼ck</button>
  </div>

  <!-- Pip-Rechner -->
  <div id="pos-mode-pips" class="stats-box sub-box" style="display:none;">
    <label>ğŸ’± Symbol:</label>
    <select id="pipSymbolSelector"></select>

    <label>ğŸ“¦ Lots:</label>
    <input type="number" id="lots" value="0.01" step="0.01">

    <label>ğŸ›‘ Stop-Loss (Pips):</label>
    <input type="number" id="slPips" placeholder="z. B. 20">

    <label>ğŸ¯ TP1 (Pips):</label>
    <input type="number" id="tp1Pips" placeholder="z. B. 50">

    <label>ğŸ¯ TP2 (Pips):</label>
    <input type="number" id="tp2Pips" placeholder="z. B. 80">

    <label>ğŸ¯ TP3 (Pips):</label>
    <input type="number" id="tp3Pips" placeholder="z. B. 100">

    <button onclick="calculatePipsByLots()">ğŸ“ Berechnen</button>
    <!-- Ergebnis-Box -->
    <div id="pipResult" class="result-box"></div>

    <button onclick="switchPosMode('main')" style="margin-top:15px; width:100%;">ğŸ” ZurÃ¼ck</button>
  </div>

</div>





  <!-- â„¹ï¸ Info-Box -->
  <div style="text-align:right; margin-bottom: 5px;">
    <span onclick="toggleInfoBox()"
          style="cursor:pointer; background:#444; border-radius:50%; padding:3px 8px;
                 font-weight:bold; color:#0ff;"
          title="ErklÃ¤rung anzeigen">i</span>
  </div>
  <div id="posInfoBox"
       style="display:none; background:#222; padding:12px; border-radius:8px; margin-top:10px;
              color:#ccc; font-size:14px; text-align:left;">
    <strong>â„¹ï¸ Was macht dieser Rechner?</strong><br><br>
    Der PositionsgrÃ¶ÃŸen-Rechner hilft dir zu ermitteln, wie viele Lots du in einem Trade einsetzen darfst, ohne mehr als einen bestimmten Prozentsatz deines Kontos zu riskieren...
  </div>
</div>

<!-- ğŸ“† Kalender -->
<div id="journalCalendarBox" class="stats-box" style="margin-top: 20px;">
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <button onclick="changeMonth(-1)">â¬…ï¸</button>
    <h3 id="calendarTitle">ğŸ—“ï¸ Journal-Kalender</h3>
    <button onclick="changeMonth(1)">â¡ï¸</button>
  </div>

  <canvas id="calendarEquityChart" height="150" style="margin:10px auto 5px auto; display:block;"></canvas>

  <div id="calendarEquityStats" style="color: #ccc; margin-top: 5px;"></div>
  <div id="calendarContainer" style="margin-top: 10px;"></div>
  <div id="calendarStats" style="margin-top: 5px; color: #ccc;"></div>
  <div id="journalEntryList" style="margin-top: 0;"></div>
</div>

<!-- ğŸ—‘ï¸ Reset-Buttons -->
<div style="margin:20px 0; text-align:center;">
  <button onclick="resetCurrentMonth()" style="margin:5px; background:#cc6600; color:white;
                                                padding:8px 15px; border:none; border-radius:5px;">
    ğŸ—“ï¸ Monat zurÃ¼cksetzen
  </button>
  <button onclick="resetSelectedDay()" style="margin:5px; background:#0066cc; color:white;
                                               padding:8px 15px; border:none; border-radius:5px;">
    ğŸ“… Tag zurÃ¼cksetzen
  </button>
  <button onclick="resetAllJournal()" style="margin:5px; background:#990000; color:white;
                                              padding:8px 15px; border:none; border-radius:5px;">
    ğŸ—‘ï¸ Alles lÃ¶schen
  </button>
</div>

<!-- ğŸ“˜ Journal-Eingabe -->
<div id="calc-journal" class="calc-box" style="display:none; margin-top: 10px;">
  <div class="stats-box journal-box">

    <!-- Strategiemodus -->
    <label>ğŸ§­ Strategie-Modus:</label>
    <select id="tradingMode" onchange="updateBiasOptions()" class="input" style="width: 100%;">
      <option value="day">Daytrading</option>
      <option value="swing">Swing-Trading</option>
    </select>

    <!-- Datum -->
    <label>ğŸ“† Datum:</label>
    <input type="date" id="journalManualDate" class="input" style="width: 100%;" />

    <!-- Symbol -->
    <label>ğŸ’± Symbol:</label>
    <input type="text" id="journalSymbol" placeholder="z. B. EUR/USD" class="input" oninput="suggestSymbol()" autocomplete="off" style="width: 100%;" />
    <div id="symbolSuggestions" style="background:#222; color:white; padding:5px; display:none; border-radius:6px;"></div>

    <!-- Einstieg + Richtung -->
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
      <div style="flex: 1; min-width: 130px;">
        <label>ğŸ¯ Einstieg:</label>
        <input type="number" id="journalEntry" class="input" onchange="autoSuggestExit()" />
      </div>
      <div style="flex: 1; min-width: 130px;">
        <label>Richtung:</label>
        <select id="journalDirection" class="input" onchange="autoSuggestExit()">
          <option value="long">ğŸ“ˆ Long</option>
          <option value="short">ğŸ“‰ Short</option>
        </select>
      </div>
    </div>

    <!-- LotgrÃ¶ÃŸe -->
    <label>ğŸ“¦ LotgrÃ¶ÃŸe:</label>
    <select id="journalLots" class="input" style="width: 100%; background-color: white; color: black;">
      <option value="">â€“ Bitte wÃ¤hlen â€“</option>
      <option value="0.01">0.01</option>
      <option value="0.02">0.02</option>
      <option value="0.03">0.03</option>
      <option value="0.05">0.05</option>
      <option value="0.10">0.10</option>
      <option value="0.25">0.25</option>
      <option value="0.50">0.50</option>
      <option value="1.00">1.00</option>
      <option value="2.00">2.00</option>
      <option value="3.00">3.00</option>
      <option value="5.00">5.00</option>
      <option value="10.00">10.00</option>
      <option value="25.00">25.00</option>
      <option value="50.00">50.00</option>
      <option value="100.00">100.00</option>
    </select>

    <!-- PnL -->
    <label>ğŸ“Š PnL (â‚¬):</label>
    <input type="text" id="journalPnL" class="input" placeholder="z. B. -50.00" style="width: 100%; background-color: white; color: black;" />

    <!-- Emotion -->
    <div class="emotion-block">
      <label>ğŸ˜ Fokus <strong>vor</strong> dem Trade:</label>
      <div id="starsBefore" class="star-rating"></div>
      <input type="hidden" id="emotionBefore" value="5" />
    </div>

    <div class="emotion-block">
      <label>ğŸ˜¤ Emotion <strong>nach</strong> dem Trade:</label>
      <div id="starsAfter" class="star-rating"></div>
      <input type="hidden" id="emotionAfter" value="5" />
    </div>

    <!-- Setup Auswahl -->
    <label>ğŸ§  Setup:</label>
    <select id="journalSetup" class="input">
      <option value="">â€“ Setup wÃ¤hlen â€“</option>
      <option value="Rejectiont">Rejection</option>
      <option value="Breakout + Rejection">Breakout + Rejection</option>
      <option value="Liquidity Grab">Liquidity Grab</option>
      <option value="Shift">Shift HTF/LTF</option>
      <option value="HH HL LH LL">HH HL LH LL</option>
    </select>

<!-- âœ… Setup-Check Box -->
<div id="setupBoxWrapper" style="margin-top: 10px; border-radius: 12px; padding: 16px; background: linear-gradient(135deg, #3d1e1e, #6b2f2f); border: 2px solid #aa3333; color: #eee; box-shadow: 0 0 8px rgba(255, 50, 50, 0.25);">
  <label style="font-weight: bold; font-size: 16px;">âœ… Setup-Check</label>

<!-- Bias Auswahl -->
<label>ğŸ§­ Multi-Timeframe Bias (max 30%):</label>
<div id="biasTimeframes" style="display: flex; flex-wrap: wrap; gap: 10px;">
  <label><input type="checkbox" value="15M" onchange="updateSetupScoreDisplay()" /> 15M</label>
  <label><input type="checkbox" value="30M" onchange="updateSetupScoreDisplay()" /> 30M</label>
  <label><input type="checkbox" value="1H" onchange="updateSetupScoreDisplay()" /> 1H</label>
  <label><input type="checkbox" value="4H" onchange="updateSetupScoreDisplay()" /> 4H</label>
  <label><input type="checkbox" value="D1" onchange="updateSetupScoreDisplay()" /> D1</label>
  <label><input type="checkbox" value="W1" onchange="updateSetupScoreDisplay()" /> W1</label>
</div>





  <!-- Checklisten (werden per JS dynamisch gezeigt) -->
  <div id="ruleChecklistSwing" class="ruleChecklist">
    <label><input id="ruleAOI" type="checkbox" value="20" onchange="updateSetupScoreDisplay()"> ğŸ§± AOI nur Weekly/Daily </label>
    <label><input id="ruleRejection" type="checkbox" value="15" onchange="updateSetupScoreDisplay()"> âŒ Kein Entry ohne Rejection </label>
    <label><input id="ruleHLH" type="checkbox" value="15" onchange="updateSetupScoreDisplay()"> ğŸ”º Buy HL (4H) | ğŸ”» Sell LH (4H) </label>
    <label><input id="ruleShift" type="checkbox" value="10" onchange="updateSetupScoreDisplay()"> ğŸ” Struktur-Shift (15Mâ€“1H) </label>
    <label><input id="ruleSLTP" type="checkbox" value="10" onchange="updateSetupScoreDisplay()"> ğŸ¯ SL/TP korrekt </label>
    <label><input id="ruleBiasW" type="checkbox" value="2" onchange="updateSetupScoreDisplay()"> ğŸ“ˆ Weekly Bias </label>
    <label><input id="ruleBiasD" type="checkbox" value="2" onchange="updateSetupScoreDisplay()"> ğŸ“Š Daily Bias </label>
    <label><input id="ruleBiasH4" type="checkbox" value="2" onchange="updateSetupScoreDisplay()"> ğŸ•“ H4 Bias </label>
    <label><input id="ruleRetest" type="checkbox" value="10" onchange="updateSetupScoreDisplay()"> ğŸ”„ Weekly Retest </label>
    <label><input id="ruleDailyRejection" type="checkbox" value="4" onchange="updateSetupScoreDisplay()"> ğŸ“‰ Daily Rejection </label>
    <label><input id="ruleCandle" type="checkbox" value="5" onchange="updateSetupScoreDisplay()"> ğŸ•¯ï¸ Candle-Muster </label>
  </div>

  <div id="ruleChecklistDay" class="ruleChecklist" style="display:none;">
    <label><input id="ruleAOI_day" type="checkbox" value="20" onchange="updateSetupScoreDisplay()"> ğŸ§± AOI nur 1H </label>
    <label><input id="ruleRejection_day" type="checkbox" value="15" onchange="updateSetupScoreDisplay()"> âŒ Kein Entry ohne Rejection </label>
    <label><input id="ruleShift_day" type="checkbox" value="10" onchange="updateSetupScoreDisplay()"> ğŸ” Struktur-Shift (5Mâ€“15M) </label>
    <label><input id="ruleSLTP_day" type="checkbox" value="10" onchange="updateSetupScoreDisplay()"> ğŸ¯ SL/TP korrekt </label>
    <label><input id="ruleSession_day" type="checkbox" value="10" onchange="updateSetupScoreDisplay()"> ğŸ•’ Session Killzone </label>
    <label><input id="ruleBias1H_day" type="checkbox" value="2" onchange="updateSetupScoreDisplay()"> ğŸ“ˆ 1H Bias </label>
    <label><input id="ruleBias4H_day" type="checkbox" value="2" onchange="updateSetupScoreDisplay()"> ğŸ•“ 4H Bias </label>
    <label><input id="ruleBiasD1_day" type="checkbox" value="2" onchange="updateSetupScoreDisplay()"> ğŸ“Š Daily Bias </label>
    <label><input id="ruleLiquidity_day" type="checkbox" value="10" onchange="updateSetupScoreDisplay()"> ğŸ’§ Liquidity Grab/FVG </label>
    <label><input id="ruleDailyRejection_day" type="checkbox" value="4" onchange="updateSetupScoreDisplay()"> ğŸ“‰ Daily Rejection </label>
    <label><input id="ruleCandle_day" type="checkbox" value="5" onchange="updateSetupScoreDisplay()"> ğŸ•¯ï¸ Candle-Muster </label>
  </div>

  <!-- Ergebnis -->
  <div id="setupScoreDisplay" style="margin-top:12px;font-weight:bold;">
    ğŸ“Š Setup-Score: <strong>0%</strong> â€“ âŒ Nicht gÃ¼ltig
  </div>
</div>




    <!-- Kommentare -->
    <div style="margin-top: 20px;">
      <label>ğŸ“ Kommentar <strong>vor dem Trade</strong>:</label>
      <textarea id="journalNotesBefore" rows="2" class="input"></textarea>

      <label>ğŸ“ Kommentar <strong>nach dem Trade</strong>:</label>
      <textarea id="journalNotesAfter" rows="2" class="input"></textarea>

      <!-- Screenshot Upload -->
      <label for="screenshotInput">ğŸ“¸ Screenshots hochladen (optional):</label>
      <input type="file" id="screenshotInput" accept="image/*" multiple class="input" />

      <!-- Speichern -->
      <button id="saveJournalEntryButton" onclick="saveJournalEntry()" style="background-color: #0077cc; color: white; padding: 14px; border-radius: 8px; margin-top: 10px; font-weight: bold; width: 100%;">
        ğŸ’¾ Eintrag speichern
      </button>
    </div>
  </div>
</div>


<!-- Lightbox fÃ¼r Screenshots -->
<div id="lightboxOverlay" style="display:none;" onclick="closeLightbox()">
  <img id="lightboxImage" src="" alt="Full Screenshot" />
</div>

<!-- ğŸ“‹ Toggle-Box -->
<div 
  onclick="toggleRules()" 
  style="
    background: linear-gradient(135deg, #2a0b0b, #1a0000);
    border: 1px solid #ff3333;
    border-radius: 6px;
    color: #fff;
    font-weight: 700;
    cursor: pointer;
    padding: 16px 20px;
    text-align: center;
    box-shadow: 
      0 0 12px rgba(255, 60, 60, 0.8),
      inset 0 0 12px rgba(255, 0, 0, 0.6);
    transition: all 0.2s ease-in-out;
  "
  onmouseover="this.style.borderColor='#ff5555'; this.style.boxShadow='0 0 20px rgba(255,80,80,1), inset 0 0 14px rgba(255,20,20,0.8)';"
  onmouseout="this.style.borderColor='#ff3333'; this.style.boxShadow='0 0 12px rgba(255,60,60,0.8), inset 0 0 12px rgba(255,0,0,0.6)';"
  onfocus="this.style.outline='3px solid #ff6666';"
  onblur="this.style.outline='none';"
>
  ğŸš€ <strong style="color:#ff6666;">Setup-Regeln anzeigen / ausblenden</strong>
</div>



<!-- ğŸ”¥ Regeln -->
<div class="rules-fire-wrapper">
  <div id="rulesBox" class="stats-box" style="display:none; line-height: 1.6;">
    <strong>ğŸ“œ Rules of Rules â€“ Deutsch</strong><br><br>

    <!-- ğŸ”˜ Umschalter -->
    <div style="text-align:right; margin-bottom:15px;">
      <button id="switchModeBtn" onclick="switchMode()">ğŸ”„ Zu Day-Trading Regeln wechseln</button>
    </div>

    <!-- ========== SWING ========== -->
    <div id="swingRules">
       <!-- Seite 1 -->
    <div id="rulePageSwing1">
      <strong>Grundregeln fÃ¼r Entry & Struktur</strong><br><br>

      <ul style="margin-left:20px;">
        <strong>AOI-Zone wÃ¤hlen:</strong><br>
          Ein Entry (Kauf/Verkauf) darf nur an einer Weekly- oder Daily-AOI stattfinden.<br>
          â†’ Alle Timeframes darunter (H4 und kleiner) dienen ausschlieÃŸlich zur Entry-BestÃ¤tigung.
        </li><br>

        <strong>Kein Entry ohne Rejection von:</strong>
          <ul style="margin-left:20px; list-style:disc;">
            <li>Strukturpunkt</li>
            <li>EMA</li>
            <li>AOI</li>
            <li>Runder psychologischer Level (00 / 50)</li>
            <li>Weekly Rejection Candle (sichtbar im Weekly oder Daily)</li>
          </ul>
        <br>

        <strong>Pflichtbedingungen fÃ¼r Buy/Sell Entry:</strong>
          <ul style="margin-left:20px; list-style:disc;">
            <li>Buy nur bei einem bestÃ¤tigten Higher Low (HL) im 4H</li>
            <li>Sell nur bei einem bestÃ¤tigten Lower High (LH) im 4H</li>
            <li>Alternativ: Potenzielles HL/LH mit Engulfing an einer AOI (Support/Resistance)</li>
          </ul>
        <br>

        <strong>Entry-Prozess nach HL/LH:</strong><br>
          Sobald ein HL oder LH gebildet wird, muss ein Struktur-Shift (15Mâ€“1H) beobachtet und mit dem hÃ¶heren TF abgeglichen werden.
        <br>

        <strong>Nach dem Struktur-Shift (15M, 30M, 1H):</strong>
          <ul style="margin-left:20px; list-style:disc;">
            <li>Suche nach einer Engulfing-Candle im 1H / 2H / 4H</li>
            <li>Je hÃ¶her der TF, desto stÃ¤rker die BestÃ¤tigung</li>
          </ul>
        
      </ul><br>

      <strong>Stop-Loss & Take-Profit Regeln</strong><br><br>
      <ul style="margin-left:20px; list-style:disc;">
        <li><strong>Stop-Loss:</strong><br>
          Der SL muss an dem Punkt gesetzt werden, an dem die Handelsidee vollstÃ¤ndig ungÃ¼ltig wird.<br>
          â†’ Alternativ am Top/Bottom des Struktur-Shifts (15M, 30M, 1H), mit 5â€“7 Pips Sicherheitsabstand.
        </li><br>

        <li><strong>Take-Profit:</strong>
          <ul style="margin-left:20px; list-style:disc;">
            <li>Wenn Entry an Weekly AOI â†’ TP1 am Strukturpunkt (KerzenkÃ¶rper des HH/LL)</li>
            <li>Wenn Entry an Daily AOI â†’ TP1 am Strukturpunkt (KerzenkÃ¶rper des HH/LL)</li>
          </ul>
        </li>
      </ul>
    </div>

    <!-- Seite 2 -->
    <div id="rulePageSwing2" style="display:none;">
      <strong>Confluence-Regeln fÃ¼r Long / Short</strong><br><br>

      <ol style="margin-left:20px;">
        <li><strong>Markt-Bias Bewertung:</strong>
          <ul style="margin-left:20px; list-style:disc;">
            <li>Weekly Bullish/Bearish: Wert 1â€“3</li>
            <li>Daily Bullish/Bearish: Wert 1â€“3</li>
            <li>4H Bullish/Bearish: Wert 1â€“3</li>
          </ul>
          Bewertungsstufen:
          <ul style="margin-left:20px; list-style:disc;">
            <li>1 = Markt oben (weit weg von AOI)</li>
            <li>2 = Auf dem Weg zur AOI</li>
            <li>3 = In der AOI</li>
          </ul>
        </li><br>

        <li><strong>Struktur-Retest (HTF):</strong><br>
          Weekly retestet vorherigen Strukturpunkt
        </li><br>

        <li><strong>Daily Rejection:</strong>
          <ul style="margin-left:20px; list-style:disc;">
            <li>Rejection an AOI</li>
            <li>Rejection an rundem psychologischen Level (00 / 50)</li>
          </ul>
        </li><br>

        <li><strong>Strukturaufbau (LTF):</strong>
          <ul style="margin-left:20px; list-style:disc;">
            <li>Warten auf HL / LH</li>
            <li>Struktur-Shift auf 15M / 30M / 1H</li>
          </ul>
        </li><br>

        <li><strong>Entry-Signal:</strong><br>
          BestÃ¤tigung durch bullisches oder bÃ¤risches Candle-Muster (1H / 2H / 4H)
        </li><br>

        <li><strong>Set and Forget:</strong><br>
          Nach Entry nicht eingreifen â€“ Setup vertrauen, kein Nachjustieren
        </li>
      </ol>
    </div>
	</div>

    <!-- ========== DAY ========== -->
<div id="dayRules" style="display:none;">

  <!-- Seite 1 Day -->
  <div id="rulePageDay1">
    <strong>Grundregeln fÃ¼r Entry & Struktur (Day-Trading)</strong><br><br>

    <ul style="margin-left:20px;">
		<strong>AOI-Zone wÃ¤hlen:</strong><br>
        Ein Entry darf nur an einer Daily- oder 4H-AOI stattfinden.<br>
        â†’ 1H/15M dienen ausschlieÃŸlich zur Entry-BestÃ¤tigung.
      <br>

      <strong>Kein Entry ohne Rejection von:</strong>
        <ul style="margin-left:20px; list-style:disc;">
          <li>Strukturpunkt</li>
          <li>EMA</li>
          <li>AOI</li>
          <li>Runder psychologischer Level (00 / 50)</li>
          <li>Daily/4H Rejection Candle</li>
        </ul>
      <br>

      <strong>Pflichtbedingungen fÃ¼r Buy/Sell Entry:</strong>
        <ul style="margin-left:20px; list-style:disc;">
          <li>Buy: bestÃ¤tigtes HL im 1H oder 4H</li>
          <li>Sell: bestÃ¤tigtes LH im 1H oder 4H</li>
          <li>Oder potenzielles HL/LH mit Engulfing an einer AOI</li>
        </ul>
      <br>

      <strong>Entry-Prozess nach HL/LH:</strong><br>
        Sobald ein HL oder LH gebildet wird, muss ein Struktur-Shift (15Mâ€“1H) beobachtet und mit dem hÃ¶heren TF (4H/D1) abgeglichen werden.
      <br>

      <strong>Nach dem Struktur-Shift (15M/1H):</strong>
        <ul style="margin-left:20px; list-style:disc;">
          <li>Suche nach einer Engulfing-Candle im 1H oder 4H</li>
        </ul>
      
    </ul><br>

    <strong>Stop-Loss & Take-Profit Regeln</strong><br><br>
    <ul style="margin-left:20px; list-style:disc;">
      <li><strong>Stop-Loss:</strong><br>
        SL am Punkt setzen, wo die Handelsidee ungÃ¼ltig wird.<br>
        â†’ Alternativ am Top/Bottom des Struktur-Shifts (15M/1H), mit 3â€“5 Pips Sicherheitsabstand.
      </li><br>

      <li><strong>Take-Profit:</strong>
        <ul style="margin-left:20px; list-style:disc;">
          <li>Wenn Entry an 4H AOI â†’ TP1 am nÃ¤chsten 1H/4H Strukturpunkt</li>
          <li>Wenn Entry an Daily AOI â†’ TP1 am Daily Strukturpunkt</li>
        </ul>
      </li>
    </ul>
  </div>

  <!-- Seite 2 Day -->
  <div id="rulePageDay2" style="display:none;">
    <strong>Confluence-Regeln fÃ¼r Long / Short (Day-Trading)</strong><br><br>

    <ol style="margin-left:20px;">
      <li><strong>Markt-Bias Bewertung:</strong>
        <ul style="margin-left:20px; list-style:disc;">
          <li>Daily Bullish/Bearish: Wert 1â€“3</li>
          <li>4H Bullish/Bearish: Wert 1â€“3</li>
          <li>1H Bullish/Bearish: Wert 1â€“3</li>
        </ul>
        Bewertungsstufen:
        <ul style="margin-left:20px; list-style:disc;">
          <li>1 = Markt oben (weit weg von AOI)</li>
          <li>2 = Auf dem Weg zur AOI</li>
          <li>3 = In der AOI</li>
        </ul>
      </li><br>

      <li><strong>Struktur-Retest:</strong><br>
        4H retestet vorherigen Strukturpunkt
      </li><br>

      <li><strong>Rejection:</strong><br>
        Daily/4H Rejection an AOI oder psychologischem Level (00/50)
      </li><br>

      <li><strong>Strukturaufbau:</strong>
        <ul style="margin-left:20px; list-style:disc;">
          <li>Warten auf HL / LH</li>
          <li>Struktur-Shift auf 15M oder 1H</li>
        </ul>
      </li><br>

      <li><strong>Entry-Signal:</strong><br>
        BestÃ¤tigung durch Candle-Muster (15M/1H)
      </li><br>

      <li><strong>Set and Forget:</strong><br>
        Nach Entry nicht eingreifen â€“ Setup vertrauen
      </li>
    </ol>
  </div>
</div>


    <!-- Navigation -->
    <div style="margin-top: 20px; display: flex; justify-content: space-between;">
      <button onclick="showPage(1)" id="prevPageBtn" style="display:none;">â¬…ï¸ ZurÃ¼ck</button>
      <button onclick="showPage(2)" id="nextPageBtn">Weiter â¡ï¸</button>
    </div>

    <div class="fire-particles"></div>
  </div>
</div>





<!-- ğŸ“œ Skript-Einbindungen -->
<script src="scripts/session-popup.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="scripts/buttons.js"></script>
<script src="scripts/session.js"></script>
<script src="scripts/screen.js"></script>
<script src="scripts/background-session.js"></script>

<!-- âœ… Erst die Daten -->
<script src="scripts/pairsData.js"></script>

<!-- âœ… Dann die Rechner -->
<script src="scripts/position.js"></script>
<script src="scripts/Piprechner.js"></script>

<!-- Rest -->
<script src="scripts/dawn.js"></script>
<script src="scripts/tax.js"></script>
<script src="imageStorage.js"></script>
<script src="scripts/bg-candles.js"></script>
<script src="scripts/ticker.js"></script>
<script src="scripts/jornal.js"></script>
<script src="scripts/pwa.js"></script>
<script src="scripts/rules.js"></script>
<script type="module" src="pocketbase-init.js"></script>



</body>









</html>
